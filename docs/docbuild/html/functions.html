

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BiblioMeter bmfuncts package &mdash; BiblioMeter 5.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="_static/graphviz.css?v=fd3f3429" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=ce74c6a2"></script>
      <script src="_static/doctools.js?v=9a2dae69"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="BiblioMeter bmgui package" href="gui.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            BiblioMeter
              <img src="_static/BM-logo.ico" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Description</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="description.html">BiblioMeter description</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">GUI</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="gui.html">BiblioMeter <cite>bmgui</cite> package</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Functions</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">BiblioMeter <cite>bmfuncts</cite> package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-bmfuncts.config_utils">bmfuncts.config_utils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.config_utils.set_org_params"><code class="docutils literal notranslate"><span class="pre">set_org_params()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.config_utils.set_user_config"><code class="docutils literal notranslate"><span class="pre">set_user_config()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-bmfuncts.consolidate_pub_list">bmfuncts.consolidate_pub_list</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.consolidate_pub_list.add_if"><code class="docutils literal notranslate"><span class="pre">add_if()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.consolidate_pub_list.add_otp"><code class="docutils literal notranslate"><span class="pre">add_otp()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.consolidate_pub_list.built_final_pub_list"><code class="docutils literal notranslate"><span class="pre">built_final_pub_list()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.consolidate_pub_list.concatenate_pub_lists"><code class="docutils literal notranslate"><span class="pre">concatenate_pub_lists()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.consolidate_pub_list.get_if_db"><code class="docutils literal notranslate"><span class="pre">get_if_db()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.consolidate_pub_list.solving_homonyms"><code class="docutils literal notranslate"><span class="pre">solving_homonyms()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.consolidate_pub_list.split_pub_list_by_doc_type"><code class="docutils literal notranslate"><span class="pre">split_pub_list_by_doc_type()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-bmfuncts.employees_globals">bmfuncts.employees_globals</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-bmfuncts.institute_globals">bmfuncts.institute_globals</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-bmfuncts.merge_pub_employees">bmfuncts.merge_pub_employees</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.merge_pub_employees.recursive_year_search"><code class="docutils literal notranslate"><span class="pre">recursive_year_search()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-bmfuncts.pub_analysis">bmfuncts.pub_analysis</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.pub_analysis.coupling_analysis"><code class="docutils literal notranslate"><span class="pre">coupling_analysis()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.pub_analysis.if_analysis"><code class="docutils literal notranslate"><span class="pre">if_analysis()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.pub_analysis.keywords_analysis"><code class="docutils literal notranslate"><span class="pre">keywords_analysis()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-bmfuncts.pub_globals">bmfuncts.pub_globals</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-bmfuncts.rename_cols">bmfuncts.rename_cols</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.rename_cols.build_col_conversion_dic"><code class="docutils literal notranslate"><span class="pre">build_col_conversion_dic()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.rename_cols.set_col_attr"><code class="docutils literal notranslate"><span class="pre">set_col_attr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.rename_cols.set_final_col_names"><code class="docutils literal notranslate"><span class="pre">set_final_col_names()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.rename_cols.set_homonym_col_names"><code class="docutils literal notranslate"><span class="pre">set_homonym_col_names()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.rename_cols.set_if_col_names"><code class="docutils literal notranslate"><span class="pre">set_if_col_names()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.rename_cols.set_otp_col_names"><code class="docutils literal notranslate"><span class="pre">set_otp_col_names()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-bmfuncts.save_final_results">bmfuncts.save_final_results</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.save_final_results.save_final_continents"><code class="docutils literal notranslate"><span class="pre">save_final_continents()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.save_final_results.save_final_countries"><code class="docutils literal notranslate"><span class="pre">save_final_countries()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.save_final_results.save_final_ifs"><code class="docutils literal notranslate"><span class="pre">save_final_ifs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.save_final_results.save_final_kws"><code class="docutils literal notranslate"><span class="pre">save_final_kws()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.save_final_results.save_final_pub_lists"><code class="docutils literal notranslate"><span class="pre">save_final_pub_lists()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.save_final_results.save_final_results"><code class="docutils literal notranslate"><span class="pre">save_final_results()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-bmfuncts.update_employees">bmfuncts.update_employees</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.update_employees.update_employees"><code class="docutils literal notranslate"><span class="pre">update_employees()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-bmfuncts.update_impact_factors">bmfuncts.update_impact_factors</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.update_impact_factors.journal_capwords"><code class="docutils literal notranslate"><span class="pre">journal_capwords()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.update_impact_factors.update_inst_if_database"><code class="docutils literal notranslate"><span class="pre">update_inst_if_database()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-bmfuncts.use_pub_attributes">bmfuncts.use_pub_attributes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.use_pub_attributes.save_homonyms"><code class="docutils literal notranslate"><span class="pre">save_homonyms()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.use_pub_attributes.save_otps"><code class="docutils literal notranslate"><span class="pre">save_otps()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.use_pub_attributes.save_shaped_homonyms_file"><code class="docutils literal notranslate"><span class="pre">save_shaped_homonyms_file()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.use_pub_attributes.set_saved_homonyms"><code class="docutils literal notranslate"><span class="pre">set_saved_homonyms()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.use_pub_attributes.set_saved_otps"><code class="docutils literal notranslate"><span class="pre">set_saved_otps()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-bmfuncts.useful_functs">bmfuncts.useful_functs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.useful_functs.check_dedup_parsing_available"><code class="docutils literal notranslate"><span class="pre">check_dedup_parsing_available()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.useful_functs.create_archi"><code class="docutils literal notranslate"><span class="pre">create_archi()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.useful_functs.create_folder"><code class="docutils literal notranslate"><span class="pre">create_folder()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.useful_functs.format_df_for_excel"><code class="docutils literal notranslate"><span class="pre">format_df_for_excel()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.useful_functs.mise_en_page"><code class="docutils literal notranslate"><span class="pre">mise_en_page()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.useful_functs.read_parsing_dict"><code class="docutils literal notranslate"><span class="pre">read_parsing_dict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.useful_functs.save_fails_dict"><code class="docutils literal notranslate"><span class="pre">save_fails_dict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.useful_functs.save_parsing_dict"><code class="docutils literal notranslate"><span class="pre">save_parsing_dict()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#bmfuncts.useful_functs.set_rawdata"><code class="docutils literal notranslate"><span class="pre">set_rawdata()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">BiblioMeter</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">BiblioMeter <cite>bmfuncts</cite> package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/functions.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="bibliometer-bmfuncts-package">
<h1>BiblioMeter <cite>bmfuncts</cite> package<a class="headerlink" href="#bibliometer-bmfuncts-package" title="Link to this heading"></a></h1>
<p>Package containing all the modules used on the backend side of the application.</p>
<section id="module-bmfuncts.config_utils">
<span id="bmfuncts-config-utils"></span><h2>bmfuncts.config_utils<a class="headerlink" href="#module-bmfuncts.config_utils" title="Link to this heading"></a></h2>
<p>The <cite>config_utils.py</cite> module gathers the useful functions
for setting the configuration parameters for the use of the BiblioMeter application.</p>
<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.config_utils.set_org_params">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.config_utils.</span></span><span class="sig-name descname"><span class="pre">set_org_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">institute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bibliometer_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/config_utils.html#set_org_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.config_utils.set_org_params" title="Link to this definition"></a></dt>
<dd><p>The <cite>set_org_params</cite> function sets the parameters of the organization
structure for the Institute and the working folder.
For that, it uses the configuration dict returned by the <cite>_get_insitute_config</cite>
function of the same module.
The parameters set are returned in a tuple as follows:
- index 0 = the dict giving the column name (str) for each department (str);
- index 1 = the dict giving the list of historical labels (str) for each department (str);
- index 2 = the dict giving the list of attributes (OTPs, str) for each department (str);
- index 3 = the list of tuples giving the potential labels (str) of the Institute
in the authors affiliations associated with the country (str) that will be used
to filter the authors affiliated to the Institute;</p>
<blockquote>
<div><p>ex: [(“LITEN”,”France”), (“INES”,”France”)]</p>
</div></blockquote>
<ul class="simple">
<li><p>index 4 = the list of columns names (str) that will be used for each of the potential labels</p></li>
</ul>
<p>of the Institute filtering the authors affiliated to the Institute;
- index 5 = the status (bool) of the impact factors database</p>
<blockquote>
<div><ul class="simple">
<li><p>True, if the database specific to the Institute will be used;</p></li>
<li><p>False, if a general database will be used;</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p>index 6 = the list of document types (str) for which the impact factors will not be analysed.</p></li>
<li><p>index 7 = the index of the main institution among the tuples at index 3;</p></li>
<li><p>index 8 = the status of the combination of the tuples at index 3;</p></li>
<li><p>index 9 = the status of splitting the file of list of publication with one row per author</p></li>
</ul>
<p>that has not been identified as Institute employee.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>institute</strong> (<em>str</em>) – The Intitute name.</p></li>
<li><p><strong>bibliometer_path</strong> (<em>path</em>) – The full path to the working folder.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple of the 9 set parameters.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(tup)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.config_utils.set_user_config">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.config_utils.</span></span><span class="sig-name descname"><span class="pre">set_user_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bibliometer_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">db_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/config_utils.html#set_user_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.config_utils.set_user_config" title="Link to this definition"></a></dt>
<dd><p>The <cite>set_user_config</cite> function sets the full paths to the rawdata folders
and to the parsing folders for the working folder selected by the user,
the corpus year ‘year’ and for each database in the list ‘db_list’.
It also sets the names of the parsing file for each parsed item.
For that, it uses the configuration dict returned by the <cite>_get_bm_parsing_config</cite>
function and the <cite>_build_files_paths</cite> function of the same module.
The parameters set are returned in a tuple as follows:
- index 1 = the hierarchical dict giving the rawdata full paths (path) for each database;
- index 2 = the hierarchical dict giving the parsing full paths (path) for each parsing step</p>
<blockquote>
<div><p>and for each database;</p>
</div></blockquote>
<ul class="simple">
<li><p>index 3 = the dict giving the name of the parsing file for each parsed item.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bibliometer_path</strong> (<em>path</em>) – The full path to the working folder.</p></li>
<li><p><strong>year</strong> (<em>str</em>) – The name of the corpus folder defined by 4 digits
corresponding to the corpus year.</p></li>
<li><p><strong>db_list</strong> (<em>list</em>) – The list of the database string names.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A tuple of the 3 parameters set.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(tup of dicts)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bmfuncts.consolidate_pub_list">
<span id="bmfuncts-consolidate-pub-list"></span><h2>bmfuncts.consolidate_pub_list<a class="headerlink" href="#module-bmfuncts.consolidate_pub_list" title="Link to this heading"></a></h2>
<p>Module of functions for the consolidation of the publications-list
in terms of:
- effective affiliation of the authors to the Institute;
- attributing department affiliation to the Institute authors;
- reduction of homonyms among the Institute authors;
- attributing OTPs to each publication;
- attributing impact factor (IF) to each publication.</p>
<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.consolidate_pub_list.add_if">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.consolidate_pub_list.</span></span><span class="sig-name descname"><span class="pre">add_if</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">institute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">org_tup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bibliometer_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">paths_tup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corpus_year</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/consolidate_pub_list.html#add_if"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.consolidate_pub_list.add_if" title="Link to this definition"></a></dt>
<dd><p>The function <cite>add_if</cite> adds two new columns containing impact factors
to the corpus dataframe ‘corpus_df’ got from a file which full path
is ‘in_file_path’.
The two columns are named through ‘corpus_year_if_col_alias’
and ‘most_recent_year_if_col’.
The impact factors are got using <cite>get_if_db</cite> function that returns
in particular the dataframe ‘if_df’ of impact-factors database.
The column ‘corpus_year_if_col_alias’ is filled with the impact-factors
values of the corpus year ‘corpus_year’ if available in the dataframe ‘if_df’,
otherwise the values are set to ‘not_available_if_alias’ value.
The column ‘most_recent_year_if_col’ is filled with the impact-factors
values of the most recent year available in the dataframe ‘if_df’.
In these columns, the NaN values of impact-factors are replaced
by ‘unknown_if_fill_alias’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>institute</strong> (<em>str</em>) – Institute name.</p></li>
<li><p><strong>org_tup</strong> (<em>tup</em>) – Contains Institute parameters.</p></li>
<li><p><strong>bibliometer_path</strong> (<em>path</em>) – Full path to working folder.</p></li>
<li><p><strong>paths_tup</strong> (<em>tup</em>) – Tuple = (full path to get the corpus dataframe ‘corpus_df’,
full path to save the missing impact-factors information,
full path to save the missing ISSNs information,
year (4 digits str) of the corpus to be appended with the two
new impact-factors columns).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple = (message indicating which file has been mofified and how,</dt><dd><p>completion status of the impact-factors database).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(tup)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.consolidate_pub_list.add_otp">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.consolidate_pub_list.</span></span><span class="sig-name descname"><span class="pre">add_otp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">institute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">org_tup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_file_base</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/consolidate_pub_list.html#add_otp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.consolidate_pub_list.add_otp" title="Link to this definition"></a></dt>
<dd><p>Creates the files for setting OTP attribute of publications by the user
for the Institute departments.
First, useful columns are added to the dataframe got from the Excel file
where homonyms have been solved by the user and pointed by ‘in_path’ path
through the <cite>_add_authors_name_list</cite> internal function.
Then, for each department, a sub_dataframe is extracted selecting rows
of publications where at least one author is affiliated to the department.
Each sub-dataframe is saved through the <cite>_save_dpt_otp_file</cite> internal function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>institute</strong> (<em>str</em>) – Institute name.</p></li>
<li><p><strong>org_tup</strong> (<em>tup</em>) – Contains Institute parameters.</p></li>
<li><p><strong>in_path</strong> (<em>path</em>) – Full path to the file where homonyms have been solved.</p></li>
<li><p><strong>out_path</strong> (<em>path</em>) – Full path to the files for setting OTPs attributes by the user.</p></li>
<li><p><strong>out_file_base</strong> (<em>str</em>) – Base for building created-files names.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>end message recalling out_path.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(str)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.consolidate_pub_list.built_final_pub_list">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.consolidate_pub_list.</span></span><span class="sig-name descname"><span class="pre">built_final_pub_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">institute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">org_tup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bibliometer_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datatype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_file_base</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corpus_year</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/consolidate_pub_list.html#built_final_pub_list"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.consolidate_pub_list.built_final_pub_list" title="Link to this definition"></a></dt>
<dd><p>The function <cite>built_final_pub_list</cite> builds the dataframe
of the publications final list of the ‘corpus_year’ corpus.
First, a ‘consolidate_pub_list_df’ dataframe is built through
the concatenation of the dataframes got from the files of
OTPs attribution to publications of each of the Institute
departments.
Meanwhile, the set OTPS are saved through the <cite>save_otps</cite>
function imported from <cite>bmfuncts.use_pub_attributes</cite> module.
The publications attributed with ‘INVALIDE’ OTP value,
(imported from globals module, imported as gg) are dropped
in the ‘consolidate_pub_list_df’ dataframe and kept in
the ‘invalid_pub_list_df’ dedicated dataframe.
These two dataframes are then saved as Excel file.
The file saved from the ‘consolidate_pub_list_df’ dataframe
is added with impact factors values through the <cite>add_if</cite> function
of the present module.
Finally, it is split by documents type through the
<cite>split_pub_list_by_doc_type</cite> function of the present module.
A copy of all the created files is made in a folder specific to
the combination type of data specified by ‘datatype’ arg
through the <cite>save_final_results</cite> function imported from
the <cite>bmfuncts.save_final_results</cite> module.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>institute</strong> (<em>str</em>) – Institute name.</p></li>
<li><p><strong>org_tup</strong> (<em>tup</em>) – Contains Institute parameters.</p></li>
<li><p><strong>bibliometer_path</strong> (<em>path</em>) – Full path to working folder.</p></li>
<li><p><strong>datatype</strong> (<em>str</em>) – Data combination type from corpuses databases.</p></li>
<li><p><strong>in_path</strong> (<em>path</em>) – Full path to folder of files where OTPs
have been attributed.</p></li>
<li><p><strong>out_path</strong> (<em>path</em>) – Full path to folder where file of
publications final list and associated files
are saved.</p></li>
<li><p><strong>in_file_base</strong> (<em>str</em>) – Base of OTPs files names.</p></li>
<li><p><strong>corpus_year</strong> (<em>str</em>) – 4 digits year of the corpus.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Returns :</dt><dd><dl class="simple">
<dt>(tup): Tuple = (end message recalling the full path to the saved file</dt><dd><p>of the publication final list,
split ratio in % of the publications final list,
completion status of the impact-factors database).</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.consolidate_pub_list.concatenate_pub_lists">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.consolidate_pub_list.</span></span><span class="sig-name descname"><span class="pre">concatenate_pub_lists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">institute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">org_tup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bibliometer_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">years_list</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/consolidate_pub_list.html#concatenate_pub_lists"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.consolidate_pub_list.concatenate_pub_lists" title="Link to this definition"></a></dt>
<dd><p>The function <cite>concatenate_pub_lists</cite> builds the concatenated dataframe
of the publications lists of the corpuses listed in ‘years_list’.
Then, the dataframe is saved through the <cite>mise_en_page</cite> function
imported from <cite>bmfuncts.useful_functs</cite> module.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>institute</strong> (<em>str</em>) – Institute name.</p></li>
<li><p><strong>org_tup</strong> (<em>tup</em>) – Contains Institute parameters.</p></li>
<li><p><strong>bibliometer_path</strong> (<em>path</em>) – Full path to working folder.</p></li>
<li><p><strong>years_list</strong> (<em>list</em>) – List of 4 digits years of the available
publications lists.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Returns :</dt><dd><p>(str): End message recalling folder and file name where file is saved.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.consolidate_pub_list.get_if_db">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.consolidate_pub_list.</span></span><span class="sig-name descname"><span class="pre">get_if_db</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">institute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">org_tup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bibliometer_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/consolidate_pub_list.html#get_if_db"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.consolidate_pub_list.get_if_db" title="Link to this definition"></a></dt>
<dd><p>The function <cite>get_if_db</cite> builds a dataframe of impact-factors
of the Institute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>institute</strong> (<em>str</em>) – Institute name.</p></li>
<li><p><strong>org_tup</strong> (<em>tup</em>) – Contains Institute parameters.</p></li>
<li><p><strong>bibliometer_path</strong> (<em>path</em>) – Full path to working folder.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple = (impact-factors (dataframe),</dt><dd><p>available-years of impact-factors in the dataframe (list),
most-recent year of available impact-factors (4-digits str)).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(tup)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.consolidate_pub_list.solving_homonyms">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.consolidate_pub_list.</span></span><span class="sig-name descname"><span class="pre">solving_homonyms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">institute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">org_tup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/consolidate_pub_list.html#solving_homonyms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.consolidate_pub_list.solving_homonyms" title="Link to this definition"></a></dt>
<dd><p>Creates the file for homonyms solving by the user.
First, a dataframe is built from specific columns
of the list of publications merged with employees database
given by the file pointed by ‘in_path’ path.
In this dataframe the homonyms are tagged by ‘HOMONYM_FLAG’
global imported from <cite>bmfuncts.pub_globals</cite> module.
Then this dataframe is saved as Excel file pointed
by ‘out_path’ path through <cite>save_shaped_homonyms_file</cite>
function imported from <cite>bmfuncts.use_pub_attributes</cite> module.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>institute</strong> (<em>str</em>) – The Intitute name.</p></li>
<li><p><strong>org_tup</strong> (<em>tup</em>) – The tuple of the organization structure of the Institute
used here to set column names for homonyms.</p></li>
<li><p><strong>in_path</strong> (<em>path</em>) – The full path to the input file of list of publications
merged with employees database.</p></li>
<li><p><strong>out_path</strong> (<em>path</em>) – The full path to the output file of homonyms solving
by the user.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>The tuple composed of end message (str)</dt><dd><p>and homonyms status (bool; True if homonyms are found).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(tup)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.consolidate_pub_list.split_pub_list_by_doc_type">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.consolidate_pub_list.</span></span><span class="sig-name descname"><span class="pre">split_pub_list_by_doc_type</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">institute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">org_tup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bibliometer_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corpus_year</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/consolidate_pub_list.html#split_pub_list_by_doc_type"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.consolidate_pub_list.split_pub_list_by_doc_type" title="Link to this definition"></a></dt>
<dd><p>The function <cite>split_pub_list_by_doc_type</cite> splits the dataframe
of the publications final list of the ‘corpus_year’ corpus into
separated dataframes corresponding to different documents types.
Then these dataframes are saved through the <cite>mise_en_page</cite> function
imported from <cite>bmfuncts.useful_functs</cite> module.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>institute</strong> (<em>str</em>) – Institute name.</p></li>
<li><p><strong>org_tup</strong> (<em>tup</em>) – Contains Institute parameters.</p></li>
<li><p><strong>bibliometer_path</strong> (<em>path</em>) – Full path to working folder.</p></li>
<li><p><strong>corpus_year</strong> (<em>str</em>) – 4 digits year of the corpus.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Split ratio in % of the publications final list.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(int)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bmfuncts.employees_globals">
<span id="bmfuncts-employees-globals"></span><h2>bmfuncts.employees_globals<a class="headerlink" href="#module-bmfuncts.employees_globals" title="Link to this heading"></a></h2>
<p>Module setting globals specific to employees database management.</p>
</section>
<section id="module-bmfuncts.institute_globals">
<span id="bmfuncts-institute-globals"></span><h2>bmfuncts.institute_globals<a class="headerlink" href="#module-bmfuncts.institute_globals" title="Link to this heading"></a></h2>
<p>Module setting globals specific to Institutes.</p>
</section>
<section id="module-bmfuncts.merge_pub_employees">
<span id="bmfuncts-merge-pub-employees"></span><h2>bmfuncts.merge_pub_employees<a class="headerlink" href="#module-bmfuncts.merge_pub_employees" title="Link to this heading"></a></h2>
<p>Module of functions for the merge of employees information with the publications list
of the Institute taking care of:
- Potential discrepancy between author-name spelling and employee-name spelling;
- Complementary database to the Institute employees database
with young researchers affiliated to the Institute;
- Inappropriate affiliation to the Institute of external collaborators;
- Creation of list of Institute authors with selected attributes;
- Creation of full reference for each publication.</p>
<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.merge_pub_employees.recursive_year_search">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.merge_pub_employees.</span></span><span class="sig-name descname"><span class="pre">recursive_year_search</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">out_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">empl_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">institute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">org_tup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bibliometer_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corpus_year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">search_depth</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress_callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress_bar_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/merge_pub_employees.html#recursive_year_search"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.merge_pub_employees.recursive_year_search" title="Link to this definition"></a></dt>
<dd><p>Searches in the employees database of the Institute the information for the authors
of the publications of a corpus through the following steps:</p>
<blockquote>
<div><ul class="simple">
<li><p>First, the publications list dataframe with one row per Institute author for each</p></li>
</ul>
<p>publication is built from the results of the corpus parsing through
the <cite>_build_institute_pubs_authors</cite> internal function.
- After that, the ‘submit_df’ dataframe of the publications list containing all matches
between Institute authors and employee names is initialized using the most recent year
of the employees database through the <cite>_build_submit_df</cite> internal function;
this is done together with the initialization of ‘orphan_df’ dataframe of the publications
list with authors not found in the employees database; these two dataframes contains
one row per author of each publication.
- Then, new rows containing the information of authors that are PhD students
at the Institute but not as employees of it are added through the <cite>_add_ext_docs</cite>
internal function updating ‘submit_df’ and ‘orphan_df’ dataframes.
- Then, new rows containing the information of authors that are under external hiring
contract at the Institute are added through the <cite>_add_other_ext</cite> internal function
updating ‘submit_df’ and ‘orphan_df’ dataframes.
- Then, ‘submit_df’ and ‘orphan_df’ dataframes are updated by search in the employees
database through the <cite>_build_submit_df</cite> internal function using recusively items from
‘years’ list for the search year; the dataframes are saved as Excel files which full
paths are given by ‘submit_path’ and ‘orphan_path’, respectively.
- Then, a new column containing the job type for each author is added in the file which
full path is given by ‘submit_path’ through the <cite>_add_author_job_type</cite> internal function.
- Then, a new column containing the full reference of each publication is added
in the file which full path is given by ‘submit_path’ through the <cite>_add_biblio_list</cite>
internal function.
- Then, column names are changed in the two files which full path are given by
respectively, ‘submit_path’ and ‘orphan_path’ through the <cite>_change_col_names</cite> internal
function.
- Finally, an Excel file containing the unique hash ID built for each publication
is created through the <cite>_creating_hash_id</cite> internal function.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out_path</strong> (<em>path</em>) – Full path to the folder for saving built dataframes.</p></li>
<li><p><strong>empl_df</strong> (<em>dataframe</em>) – Hierarchical employees database keyyed by ‘years’ list.</p></li>
<li><p><strong>institute</strong> (<em>str</em>) – Institute name.</p></li>
<li><p><strong>org_tup</strong> (<em>tup</em>) – Contains Institute parameters.</p></li>
<li><p><strong>bibliometer_path</strong> (<em>path</em>) – Full path to working folder.</p></li>
<li><p><strong>corpus_year</strong> (<em>str</em>) – Contains the corpus year defined by 4 digits.</p></li>
<li><p><strong>search_depth</strong> (<em>int</em>) – Depth for search in ‘empl_df’ using ‘years’ list.</p></li>
<li><p><strong>progress_callback</strong> (<em>function</em>) – Function for updating ProgressBar
tkinter widget status (default = None).</p></li>
<li><p><strong>progress_bar_state</strong> (<em>int</em>) – Initial status of ProgressBar tkinter widget
(default = None).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple = (end_message (str), empty status (bool) of the publications</dt><dd><p>list with authors not found in the employees database)</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(tup)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bmfuncts.pub_analysis">
<span id="bmfuncts-pub-analysis"></span><h2>bmfuncts.pub_analysis<a class="headerlink" href="#module-bmfuncts.pub_analysis" title="Link to this heading"></a></h2>
<p>Module of functions for publications-list analysis
in terms of impact factors, key words and geographical collaborations.
To do: Analysis of co-publication with other institutions and
publications per OTPs.</p>
<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.pub_analysis.coupling_analysis">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.pub_analysis.</span></span><span class="sig-name descname"><span class="pre">coupling_analysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">institute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">org_tup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bibliometer_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datatype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress_callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/pub_analysis.html#coupling_analysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.pub_analysis.coupling_analysis" title="Link to this definition"></a></dt>
<dd><p>Performs the analysis of countries and authors affiliations of Institute publications
of the ‘year’ corpus.
To do that:</p>
<blockquote>
<div><ul class="simple">
<li><p>First, gets the ‘all_address_df’ dataframe of authors addresses from the file which full path</p></li>
</ul>
<p>is given by ‘addresses_item_path’ and that is a deduplication results of the parsing step
of the corpus.</p>
<ul class="simple">
<li><p>Then, builds the ‘inst_pub_addresses_df’ dataframe by selecting in ‘all_address_df’ dataframe</p></li>
</ul>
<p>only addresses related to publications of the Institute.</p>
<ul class="simple">
<li><p>Then, builds the dataframes of countries, normalized institutions and raw institutions</p></li>
</ul>
<p>through the <cite>build_norm_raw_institutions</cite> function imported from the package imported as bp,
using ‘inst_pub_addresses_df’ dataframe and specific files for this function; in these datraframes,
each row contains:</p>
<blockquote>
<div><ul class="simple">
<li><p>a publication IDs</p></li>
<li><p>the index of an address of the publication addresses</p></li>
<li><p>the country of the given address</p></li>
<li><p>and for the institutions dataframes, the list of normalized institutions or the list of raw</p></li>
</ul>
<p>institutions for the given address.</p>
</div></blockquote>
<ul class="simple">
<li><p>Then, completes the normalized institutions and raw institutions dataframes with country</p></li>
</ul>
<p>information by <cite>_copy_dg_col_to_df</cite> local function.</p>
<ul class="simple">
<li><p>Then, modifyes the publication_IDs by <cite>_year_pub_id</cite> local function in the 3 dataframes.</p></li>
<li><p>Then, saves the normalized institutions and raw institutions dataframes through the</p></li>
</ul>
<p><cite>_save_formatted_df_to_xlsx</cite> local function.</p>
<ul class="simple">
<li><p>Then, builds the publications statistics dataframes per country and per continent using</p></li>
</ul>
<p>the <cite>_build_countries_stat</cite> and <cite>_build_continents_stat</cite> internal functions.</p>
<ul class="simple">
<li><p>Then, saves the statistics dataframes through the <cite>_save_formatted_df_to_xlsx</cite></p></li>
</ul>
<p>local function.</p>
<ul class="simple">
<li><p>Finally, saves the results of this analysis for the ‘datatype’ case through the</p></li>
</ul>
<p><cite>save_final_results</cite> function imported from <cite>bmfuncts.save_final_results</cite> module.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>institute</strong> (<em>str</em>) – Institute name.</p></li>
<li><p><strong>org_tup</strong> (<em>tup</em>) – Contains Institute parameters.</p></li>
<li><p><strong>bibliometer_path</strong> (<em>path</em>) – Full path to working folder.</p></li>
<li><p><strong>datatype</strong> (<em>str</em>) – Data combination type from corpuses databases.</p></li>
<li><p><strong>year</strong> (<em>str</em>) – 4 digits year of the corpus.</p></li>
<li><p><strong>progress_callback</strong> (<em>function</em>) – Function for updating ProgressBar
tkinter widget status (default = None).</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Status of prints (default = False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Full path to the folder where results of keywords analysis are saved.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(path)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.pub_analysis.if_analysis">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.pub_analysis.</span></span><span class="sig-name descname"><span class="pre">if_analysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">institute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">org_tup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bibliometer_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datatype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corpus_year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">if_most_recent_year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress_callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/pub_analysis.html#if_analysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.pub_analysis.if_analysis" title="Link to this definition"></a></dt>
<dd><p>Performs the analysis of journal impact_factors (IFs) of the ‘corpus_year’ corpus.
To do that:</p>
<blockquote>
<div><ul class="simple">
<li><p>First, gets deduplication results of the parsing step trough the <cite>read_parsing_dict</cite></p></li>
</ul>
<p>function imported from <cite>bmfuncts.useful_functs</cite> module.</p>
<ul class="simple">
<li><p>Then, builds the dataframe of publications list to be analyzed using</p></li>
</ul>
<p>normalized journal names available in the deduplicated list of publications
resulting from the parsing step.</p>
<ul class="simple">
<li><p>Then, builds the IFs data resulting from IFs analysis of this dataframe</p></li>
</ul>
<blockquote>
<div><p>through the <cite>_build_analysis_if_data</cite> internal function and saves them as xlsx files.</p>
</div></blockquote>
<ul class="simple">
<li><p>Then, updates database of key performance indicators (KPIs) of the Institute</p></li>
</ul>
<p>with the results of this analysis through the <cite>_update_kpi_database</cite> internal function.</p>
<ul class="simple">
<li><p>Finally, saves the results of this analysis for the ‘datatype’ case through the</p></li>
</ul>
<p><cite>save_final_results</cite> function imported from <cite>bmfuncts.save_final_results</cite> module.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>institute</strong> (<em>str</em>) – Institute name.</p></li>
<li><p><strong>org_tup</strong> (<em>tup</em>) – Contains Institute parameters.</p></li>
<li><p><strong>bibliometer_path</strong> (<em>path</em>) – Full path to working folder.</p></li>
<li><p><strong>datatype</strong> (<em>str</em>) – Data combination type from corpuses databases.</p></li>
<li><p><strong>corpus_year</strong> (<em>str</em>) – 4 digits year of the corpus.</p></li>
<li><p><strong>if_most_recent_year</strong> (<em>str</em>) – Most recent year of impact factors.</p></li>
<li><p><strong>progress_callback</strong> (<em>function</em>) – Function for updating ProgressBar
tkinter widget status (default = None).</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Status of prints (default = False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple = (full path to the folder where results</dt><dd><p>of impact-factors analysis are saved,
dataframe of Institute KPIs database,
dict of Institute KPIs).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(tup)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.pub_analysis.keywords_analysis">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.pub_analysis.</span></span><span class="sig-name descname"><span class="pre">keywords_analysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">institute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">org_tup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bibliometer_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datatype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress_callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/pub_analysis.html#keywords_analysis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.pub_analysis.keywords_analysis" title="Link to this definition"></a></dt>
<dd><p>Performs the analysis of publications keywords (KWs) of the ‘year’ corpus.
To do that:</p>
<blockquote>
<div><ul class="simple">
<li><p>First, gets deduplication results of the parsing step trough the</p></li>
</ul>
<p><cite>read_parsing_dict</cite> function imported from <cite>bmfuncts.useful_functs</cite> module.
- Then, builds the dataframe of publications list to be analyzed specifying
the useful columns;
- Then, loops on KW type among author KW (AK), indexed KW (IK) and title KW (TK) for:</p>
<blockquote>
<div><ul class="simple">
<li><p>building the dataframe of KW list to be analyzed given by the deduplication</p></li>
</ul>
<p>results of the parsing step;
- creating KW analysis data through the <cite>_create_kw_analysis_data</cite> internal function;</p>
</div></blockquote>
<ul class="simple">
<li><p>Finally, saves the results of this analysis for the ‘datatype’ case through the</p></li>
</ul>
<p><cite>save_final_results</cite> function imported from <cite>bmfuncts.save_final_results</cite> module.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>institute</strong> (<em>str</em>) – Institute name.</p></li>
<li><p><strong>org_tup</strong> (<em>tup</em>) – Contains Institute parameters.</p></li>
<li><p><strong>bibliometer_path</strong> (<em>path</em>) – Full path to working folder.</p></li>
<li><p><strong>datatype</strong> (<em>str</em>) – Data combination type from corpuses databases.</p></li>
<li><p><strong>year</strong> (<em>str</em>) – 4 digits year of the corpus.</p></li>
<li><p><strong>progress_callback</strong> (<em>function</em>) – Function for updating ProgressBar
tkinter widget status (default = None).</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Status of prints (default = False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Full path to the folder where results of keywords analysis are saved.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(path)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bmfuncts.pub_globals">
<span id="bmfuncts-pub-globals"></span><h2>bmfuncts.pub_globals<a class="headerlink" href="#module-bmfuncts.pub_globals" title="Link to this heading"></a></h2>
<p>Module for setting globals specific to publications
management and analysis.</p>
</section>
<section id="module-bmfuncts.rename_cols">
<span id="bmfuncts-rename-cols"></span><h2>bmfuncts.rename_cols<a class="headerlink" href="#module-bmfuncts.rename_cols" title="Link to this heading"></a></h2>
<p>Module of useful functions for setting columns names of dataframes.</p>
<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.rename_cols.build_col_conversion_dic">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.rename_cols.</span></span><span class="sig-name descname"><span class="pre">build_col_conversion_dic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">institute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">org_tup</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/rename_cols.html#build_col_conversion_dic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.rename_cols.build_col_conversion_dic" title="Link to this definition"></a></dt>
<dd><p>Builds a dict for setting the final column names
given the initial column names of 3 dataframes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>institute</strong> (<em>str</em>) – The Intitute name.</p></li>
<li><p><strong>org_tup</strong> (<em>tup</em>) – The tuple of the organization structure
of the Institute.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple = (dict for renaming the specific columns of the dataframe</dt><dd><p>of publications list with one row per author that has not been
identified as Institute employee,
dict for renaming the specific columns of the dataframe of merged
employees information with the publications list with one
row per Institute author,
dict for renaming the columns of all the results dataframes).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(tup)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.rename_cols.set_col_attr">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.rename_cols.</span></span><span class="sig-name descname"><span class="pre">set_col_attr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">institute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">org_tup</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/rename_cols.html#set_col_attr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.rename_cols.set_col_attr" title="Link to this definition"></a></dt>
<dd><p>Sets the dict for setting the final column attributes
in terms of width and alignment to be used for formating
datarames before openpyxl save.
The final column names are got through the
<cite>build_col_conversion_dic</cite> internal function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>institute</strong> (<em>str</em>) – The Intitute name.</p></li>
<li><p><strong>org_tup</strong> (<em>tup</em>) – The tuple of the organization structure
of the Institute.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple = (dict to be used for setting the final column attributes</dt><dd><p>for formating datarames before openpyxl save,
list of the final column names that have attributes).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(tup)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.rename_cols.set_final_col_names">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.rename_cols.</span></span><span class="sig-name descname"><span class="pre">set_final_col_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">institute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">org_tup</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/rename_cols.html#set_final_col_names"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.rename_cols.set_final_col_names" title="Link to this definition"></a></dt>
<dd><p>Sets through the <cite>build_col_conversion_dic</cite> internal function
the dict for setting the final column names to be used for building
the final publications-list dataframe.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>institute</strong> (<em>str</em>) – The Intitute name.</p></li>
<li><p><strong>org_tup</strong> (<em>tup</em>) – The tuple of the organization structure
of the Institute.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple = (dict to be used for setting the final</dt><dd><p>column names of the final publications-list dataframe,
list of the final column names of the departments).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(tup)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.rename_cols.set_homonym_col_names">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.rename_cols.</span></span><span class="sig-name descname"><span class="pre">set_homonym_col_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">institute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">org_tup</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/rename_cols.html#set_homonym_col_names"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.rename_cols.set_homonym_col_names" title="Link to this definition"></a></dt>
<dd><p>Sets through the <cite>build_col_conversion_dic</cite> internal function
the dict for setting the final column names to be used for building
the dataframe for homonyms solving by the user .</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>institute</strong> (<em>str</em>) – The Intitute name.</p></li>
<li><p><strong>org_tup</strong> (<em>tup</em>) – The tuple of the organization structure
of the Institute.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>To be used for setting the final column names</dt><dd><p>of the dataframe built for homonyms solving
by the user.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.rename_cols.set_if_col_names">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.rename_cols.</span></span><span class="sig-name descname"><span class="pre">set_if_col_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">institute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">org_tup</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/rename_cols.html#set_if_col_names"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.rename_cols.set_if_col_names" title="Link to this definition"></a></dt>
<dd><p>Sets through the <cite>set_final_col_names</cite> internal function
the dict for setting the final column names, including columns
specific to impact-factors, to be used for updating the final
publications-list dataframe with impact factors values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>institute</strong> (<em>str</em>) – The Intitute name.</p></li>
<li><p><strong>org_tup</strong> (<em>tup</em>) – The tuple of the organization structure
of the Institute.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>To to be used for updating the final publications-list</dt><dd><p>dataframe with impact factors values.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.rename_cols.set_otp_col_names">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.rename_cols.</span></span><span class="sig-name descname"><span class="pre">set_otp_col_names</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">institute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">org_tup</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/rename_cols.html#set_otp_col_names"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.rename_cols.set_otp_col_names" title="Link to this definition"></a></dt>
<dd><p>Sets through the <cite>build_col_conversion_dic</cite> internal function
the dict for setting the final column names to be used for building
the dataframes for OTPs attribution by the user .</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>institute</strong> (<em>str</em>) – The Intitute name.</p></li>
<li><p><strong>org_tup</strong> (<em>tup</em>) – The tuple of the organization structure
of the Institute.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>To be used for setting the final column names of the</dt><dd><p>dataframes built for OTPs attribution by the user.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(dict)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bmfuncts.save_final_results">
<span id="bmfuncts-save-final-results"></span><h2>bmfuncts.save_final_results<a class="headerlink" href="#module-bmfuncts.save_final_results" title="Link to this heading"></a></h2>
<p>Module of functions for saving final results.</p>
<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.save_final_results.save_final_continents">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.save_final_results.</span></span><span class="sig-name descname"><span class="pre">save_final_continents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bibliometer_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corpus_year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_folder_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/save_final_results.html#save_final_continents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.save_final_results.save_final_continents" title="Link to this definition"></a></dt>
<dd><p>Saves final results of publications per continent for the corpus year.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bibliometer_path</strong> (<em>path</em>) – Full path to working folder.</p></li>
<li><p><strong>corpus_year</strong> (<em>str</em>) – 4 digits year of the corpus.</p></li>
<li><p><strong>results_folder_path</strong> (<em>path</em>) – Full path to the folder where final
results have to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>End message recalling corpus year and full path to</dt><dd><p>the folder where final results have been saved.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(str)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.save_final_results.save_final_countries">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.save_final_results.</span></span><span class="sig-name descname"><span class="pre">save_final_countries</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bibliometer_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corpus_year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_folder_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/save_final_results.html#save_final_countries"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.save_final_results.save_final_countries" title="Link to this definition"></a></dt>
<dd><p>Saves final results of publications per country for the corpus year.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bibliometer_path</strong> (<em>path</em>) – Full path to working folder.</p></li>
<li><p><strong>corpus_year</strong> (<em>str</em>) – 4 digits year of the corpus.</p></li>
<li><p><strong>results_folder_path</strong> (<em>path</em>) – Full path to the folder where final
results have to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>End message recalling corpus year and full path to</dt><dd><p>the folder where final results have been saved.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(str)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.save_final_results.save_final_ifs">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.save_final_results.</span></span><span class="sig-name descname"><span class="pre">save_final_ifs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">institute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">org_tup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bibliometer_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corpus_year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_folder_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">if_analysis_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/save_final_results.html#save_final_ifs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.save_final_results.save_final_ifs" title="Link to this definition"></a></dt>
<dd><p>Saves final results of number of publications per journal
with its impact factor for the corpus year.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bibliometer_path</strong> (<em>path</em>) – Full path to working folder.</p></li>
<li><p><strong>corpus_year</strong> (<em>str</em>) – 4 digits year of the corpus.</p></li>
<li><p><strong>results_folder_path</strong> (<em>path</em>) – Full path to the folder where final
results have to be saved.</p></li>
<li><p><strong>if_analysis_name</strong> (<em>str</em>) – Base for building file names for saving
impact-factors results.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>End message recalling corpus year and full path to</dt><dd><p>the folder where final results have been saved.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(str)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.save_final_results.save_final_kws">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.save_final_results.</span></span><span class="sig-name descname"><span class="pre">save_final_kws</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">institute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">org_tup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bibliometer_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corpus_year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_folder_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/save_final_results.html#save_final_kws"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.save_final_results.save_final_kws" title="Link to this definition"></a></dt>
<dd><p>Saves final results of number of publications per keyword for the corpus year.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bibliometer_path</strong> (<em>path</em>) – Full path to working folder.</p></li>
<li><p><strong>corpus_year</strong> (<em>str</em>) – 4 digits year of the corpus.</p></li>
<li><p><strong>results_folder_path</strong> (<em>path</em>) – Full path to the folder where final
results have to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>End message recalling corpus year and full path to</dt><dd><p>the folder where final results have been saved.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(str)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.save_final_results.save_final_pub_lists">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.save_final_results.</span></span><span class="sig-name descname"><span class="pre">save_final_pub_lists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bibliometer_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corpus_year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_folder_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/save_final_results.html#save_final_pub_lists"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.save_final_results.save_final_pub_lists" title="Link to this definition"></a></dt>
<dd><p>Saves final results of the publications lists for the corpus year.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bibliometer_path</strong> (<em>path</em>) – Full path to working folder.</p></li>
<li><p><strong>corpus_year</strong> (<em>str</em>) – 4 digits year of the corpus.</p></li>
<li><p><strong>results_folder_path</strong> (<em>path</em>) – Full path to the folder where final
results have to be saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>End message recalling corpus year and full path to</dt><dd><p>the folder where final results have been saved.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(str)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.save_final_results.save_final_results">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.save_final_results.</span></span><span class="sig-name descname"><span class="pre">save_final_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">institute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">org_tup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bibliometer_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datatype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corpus_year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">if_analysis_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">results_to_save_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/save_final_results.html#save_final_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.save_final_results.save_final_results" title="Link to this definition"></a></dt>
<dd><p>Saves final results of given datatype and corpus year according
to the saving status of the following types of results: publications lists,
impact factors, keywords countries and continents.
To do: Saving the results of co-publication with other institutions
and publications per OTPs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>institute</strong> (<em>str</em>) – Institute name.</p></li>
<li><p><strong>org_tup</strong> (<em>tup</em>) – Contains Institute parameters.</p></li>
<li><p><strong>bibliometer_path</strong> (<em>path</em>) – Full path to working folder.</p></li>
<li><p><strong>datatype</strong> (<em>str</em>) – Data combination type from corpuses databases.</p></li>
<li><p><strong>corpus_year</strong> (<em>str</em>) – 4 digits year of the corpus.</p></li>
<li><p><strong>if_analysis_name</strong> (<em>str</em>) – Base for building file names for saving
impact-factors type of results.</p></li>
<li><p><strong>results_to_save_dict</strong> (<em>dict</em>) – Dict keyyed by the type of results
to save and valued by saving status
(bool; True if the type of results
should be saved).</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Status of prints (default = False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>End message recalling corpus year and full path to</dt><dd><p>the folder where final results have been saved.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(str)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bmfuncts.update_employees">
<span id="bmfuncts-update-employees"></span><h2>bmfuncts.update_employees<a class="headerlink" href="#module-bmfuncts.update_employees" title="Link to this heading"></a></h2>
<p>Module of functions for the update of the employees database.</p>
<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.update_employees.update_employees">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.update_employees.</span></span><span class="sig-name descname"><span class="pre">update_employees</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bibliometer_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress_callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/update_employees.html#update_employees"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.update_employees.update_employees" title="Link to this definition"></a></dt>
<dd><p>The function <cite>update_employees</cite> update the file defined by the global
‘EMPLOYEES_ARCHI’ at key ‘employees_file_name’ using the file defined
by the global ‘EMPLOYEES_ARCHI’ at key “one_year_employees_filebase”
and the year ‘year’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bibliometer_path</strong> (<em>path</em>) – The path to the working folder.</p></li>
<li><p><strong>progress_callback</strong> (<em>function</em>) – Function for updating ProgressBar
tkinter widget status (default = None).</p></li>
<li><p><strong>replace</strong> (<em>bool</em>) – Optional (default = True); if true, existing sheets
are replaced in employees EXCEL files specific to a year.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple of 5 strings; a first string giving the employees year</dt><dd><p>if no error is raised; then 4 strings specifying errors related
respectively to files number, sheet-name, column name and number
of years to update; these 4 strings are set to “None” when no error is raised.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(tuple)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bmfuncts.update_impact_factors">
<span id="bmfuncts-update-impact-factors"></span><h2>bmfuncts.update_impact_factors<a class="headerlink" href="#module-bmfuncts.update_impact_factors" title="Link to this heading"></a></h2>
<p>Module of functions for updating impact factors in database
and in publications lists</p>
<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.update_impact_factors.journal_capwords">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.update_impact_factors.</span></span><span class="sig-name descname"><span class="pre">journal_capwords</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">text</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/update_impact_factors.html#journal_capwords"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.update_impact_factors.journal_capwords" title="Link to this definition"></a></dt>
<dd><p>Capitalizes words in journal names except those given
by the ‘BM_LOW_WORDS_LIST’ global import from globals
module imported as pg.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>text</strong> (<em>str</em>) – Journal name to be capitalized by words.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Journal name capitalized by main words.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(str)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.update_impact_factors.update_inst_if_database">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.update_impact_factors.</span></span><span class="sig-name descname"><span class="pre">update_inst_if_database</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">institute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">org_tup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bibliometer_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corpi_years_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">progress_callback</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/update_impact_factors.html#update_inst_if_database"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.update_impact_factors.update_inst_if_database" title="Link to this definition"></a></dt>
<dd><p>Updates the impact-factors (IFs) database of the Institute using the files
where IFs have been added by the user for each existing corpuses.
To do that:</p>
<blockquote>
<div><ul class="simple">
<li><p>First, Gets the initial all-years database which full path is given by</p></li>
</ul>
<p>‘inst_all_if_path’.
- Then, sets useful parameters for using <cite>_build_previous_years_if_df</cite> and
<cite>_build_recent_year_if_df</cite> internal functions, including ‘wb’ workbook for
saving updated IFs database as multisheet workbook.
- Then, updates ‘wb’ workbook through the <cite>_build_previous_years_if_df</cite>
internal function to build fully updated IFs database for years before
the most recent year available for IFs.
- Then, updates ‘wb’ workbook through the <cite>_build_recent_year_if_df</cite>
internal function to build fully updated IFs database for years beginning
from the most recent year available for IFs.
- Finally, saves the ‘wb’ workbook using the ‘inst_all_if_path’ full path.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>institute</strong> (<em>str</em>) – Institute name.</p></li>
<li><p><strong>org_tup</strong> (<em>tup</em>) – Contains Institute parameters.</p></li>
<li><p><strong>bibliometer_path</strong> (<em>path</em>) – Full path to working folder.</p></li>
<li><p><strong>progress_callback</strong> (<em>function</em>) – Function for updating ProgressBar
tkinter widget status (default = None).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple = (end message recalling the full path to the saved file</dt><dd><p>of the IFs database (str), List of IFs-database years (4-digits strings)).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(tup)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bmfuncts.use_pub_attributes">
<span id="bmfuncts-use-pub-attributes"></span><h2>bmfuncts.use_pub_attributes<a class="headerlink" href="#module-bmfuncts.use_pub_attributes" title="Link to this heading"></a></h2>
<p>Module of functions for using publications attributes
such as homonyms and OTPs.</p>
<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.use_pub_attributes.save_homonyms">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.use_pub_attributes.</span></span><span class="sig-name descname"><span class="pre">save_homonyms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">institute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">org_tup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bibliometer_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corpus_year</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/use_pub_attributes.html#save_homonyms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.use_pub_attributes.save_homonyms" title="Link to this definition"></a></dt>
<dd><p>Saves the history of the resolved homonyms by the user.
First, builds the dataframe to save with following columns:</p>
<blockquote>
<div><ul class="simple">
<li><p>hash-ID of the publication for which homonyms have been solved;</p></li>
<li><p>the personal number of the kept author among the homonyms.</p></li>
</ul>
</div></blockquote>
<p>Then, saves the dataframe as Excel file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>institute</strong> (<em>str</em>) – Institute name.</p></li>
<li><p><strong>org_tup</strong> (<em>tup</em>) – Contains Institute parameters.</p></li>
<li><p><strong>bibliometer_path</strong> (<em>path</em>) – Full path to working folder.</p></li>
<li><p><strong>corpus_year</strong> (<em>str</em>) – 4 digits year of the corpus.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>End message.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(str)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.use_pub_attributes.save_otps">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.use_pub_attributes.</span></span><span class="sig-name descname"><span class="pre">save_otps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">institute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">org_tup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bibliometer_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corpus_year</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/use_pub_attributes.html#save_otps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.use_pub_attributes.save_otps" title="Link to this definition"></a></dt>
<dd><p>Saves the history of the attributed OTPs by the user.
First, builds the dataframe to save with 2 sheets:</p>
<blockquote>
<div><ul class="simple">
<li><p>A sheet which name is given by ‘SHEET_SAVE_OTP’ global at key ‘hash_OTP’</p></li>
</ul>
<dl class="simple">
<dt>with the following columns:</dt><dd><ul class="simple">
<li><p>hash-ID of the publication for which OTPs have been attributed;</p></li>
<li><p>the OTPs value attributed.</p></li>
</ul>
</dd>
</dl>
<ul class="simple">
<li><p>A sheet which name is given by ‘SHEET_SAVE_OTP’ global at key ‘doi_OTP’</p></li>
</ul>
<dl>
<dt>with the following columns:</dt><dd><ul class="simple">
<li><p>Full name (last name + first name initials) of the first author</p></li>
</ul>
<p>of the publication for which OTPs have been attributed;
- DOI of the publication for which OTPs have been attributed;
- the OTPs value attributed.</p>
</dd>
</dl>
</div></blockquote>
<p>Then, saves the dataframe as Excel file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>institute</strong> (<em>str</em>) – Institute name.</p></li>
<li><p><strong>org_tup</strong> (<em>tup</em>) – Contains Institute parameters.</p></li>
<li><p><strong>bibliometer_path</strong> (<em>path</em>) – Full path to working folder.</p></li>
<li><p><strong>corpus_year</strong> (<em>str</em>) – 4 digits year of the corpus.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>End message.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(str)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.use_pub_attributes.save_shaped_homonyms_file">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.use_pub_attributes.</span></span><span class="sig-name descname"><span class="pre">save_shaped_homonyms_file</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">homonyms_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/use_pub_attributes.html#save_shaped_homonyms_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.use_pub_attributes.save_shaped_homonyms_file" title="Link to this definition"></a></dt>
<dd><p>Saves as openpyxl workbook the dataframe for resolving
homonymies by the user.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>homonyms_df</strong> (<em>dtaframe</em>) – Data for resolving homonymies.</p></li>
<li><p><strong>out_path</strong> (<em>path</em>) – Full path for saving the created workbook.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.use_pub_attributes.set_saved_homonyms">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.use_pub_attributes.</span></span><span class="sig-name descname"><span class="pre">set_saved_homonyms</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">institute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">org_tup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bibliometer_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corpus_year</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">actual_homonym_status</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/use_pub_attributes.html#set_saved_homonyms"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.use_pub_attributes.set_saved_homonyms" title="Link to this definition"></a></dt>
<dd><p>Resolves the homonyms from the history of the resolved homonyms
before submiting the file for resolving remaining homonyms to the user.
First, builds the dataframe with solved homonyms and homonyms remaining
to be solved.
Then, saves the dataframe through the <cite>save_shaped_homonyms_file</cite>
internal function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>institute</strong> (<em>str</em>) – Institute name.</p></li>
<li><p><strong>org_tup</strong> (<em>tup</em>) – Contains Institute parameters.</p></li>
<li><p><strong>bibliometer_path</strong> (<em>path</em>) – Full path to working folder.</p></li>
<li><p><strong>corpus_year</strong> (<em>str</em>) – 4 digits year of the corpus.</p></li>
<li><p><strong>actual_homonym_status</strong> (<em>bool</em>) – True if homonyms exists.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple = (End message (str), actualized homonyms</dt><dd><p>status (bool).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(tup)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.use_pub_attributes.set_saved_otps">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.use_pub_attributes.</span></span><span class="sig-name descname"><span class="pre">set_saved_otps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">institute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">org_tup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bibliometer_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corpus_year</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/use_pub_attributes.html#set_saved_otps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.use_pub_attributes.set_saved_otps" title="Link to this definition"></a></dt>
<dd><p>Attributes the OTPs from the history of the attributed OTPs
before submiting to the user the file for attributing the not yet
attributed OTPs.
Loops on department to:</p>
<blockquote>
<div><ul class="simple">
<li><p>First, builds the dataframe with already attributed OTPs</p></li>
</ul>
</div></blockquote>
<dl class="simple">
<dt>and OTPs remaining to be attributed.</dt><dd><ul class="simple">
<li><p>Then, saves the file to be submitted to the user through the</p></li>
</ul>
</dd>
</dl>
<p><cite>_re_save_dpt_otp_file</cite> internal function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>institute</strong> (<em>str</em>) – Institute name.</p></li>
<li><p><strong>org_tup</strong> (<em>tup</em>) – Contains Institute parameters.</p></li>
<li><p><strong>bibliometer_path</strong> (<em>path</em>) – Full path to working folder.</p></li>
<li><p><strong>corpus_year</strong> (<em>str</em>) – 4 digits year of the corpus.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>End message giving the status of the OTPs attribution.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(str)</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-bmfuncts.useful_functs">
<span id="bmfuncts-useful-functs"></span><h2>bmfuncts.useful_functs<a class="headerlink" href="#module-bmfuncts.useful_functs" title="Link to this heading"></a></h2>
<p>Module of useful functions used by several modules of package <cite>bmfuncts</cite>.</p>
<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.useful_functs.check_dedup_parsing_available">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.useful_functs.</span></span><span class="sig-name descname"><span class="pre">check_dedup_parsing_available</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bibliometer_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">year</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/useful_functs.html#check_dedup_parsing_available"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.useful_functs.check_dedup_parsing_available" title="Link to this definition"></a></dt>
<dd><p>Checks if deduplication parsing folder exist and not empty.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bibliometer_path</strong> (<em>path</em>) – Full path to working folder.</p></li>
<li><p><strong>year</strong> (<em>str</em>) – 4 digits year of the corpus.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Status of the deduplication parsing folder</dt><dd><p>(False if folder does’nt exist or is empty).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(bool)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.useful_functs.create_archi">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.useful_functs.</span></span><span class="sig-name descname"><span class="pre">create_archi</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bibliometer_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corpus_year_folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/useful_functs.html#create_archi"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.useful_functs.create_archi" title="Link to this definition"></a></dt>
<dd><p>Creates a corpus folder with the required architecture.
It uses the global “ARCHI_YEAR” for the names of the sub_folders.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bibliometer_path</strong> (<em>path</em>) – The full path of the working folder.</p></li>
<li><p><strong>corpus_year_folder</strong> (<em>str</em>) – The name of the folder of the corpus.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Optional status of prints (default = False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>End message recalling the folder created.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(str)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.useful_functs.create_folder">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.useful_functs.</span></span><span class="sig-name descname"><span class="pre">create_folder</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">folder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/useful_functs.html#create_folder"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.useful_functs.create_folder" title="Link to this definition"></a></dt>
<dd><p>Creates a folder checking first if it already exists.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>root_path</strong> (<em>path</em>) – Full path to the folder where
the new folder is created.</p></li>
<li><p><strong>folder</strong> (<em>str</em>) – Name of the folder to be created.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Optional status of prints (default = False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Full path to the created folder.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(path)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.useful_functs.format_df_for_excel">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.useful_functs.</span></span><span class="sig-name descname"><span class="pre">format_df_for_excel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">first_col_width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">last_col_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/useful_functs.html#format_df_for_excel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.useful_functs.format_df_for_excel" title="Link to this definition"></a></dt>
<dd><p>Generates a well formatted openpyxl workbook from
the ‘df’ dataframe for sake of lisibilty when saved
as Excel file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>dataframe</em>) – Data to be formatted in an openpyxl workbook.</p></li>
<li><p><strong>first_col_width</strong> (<em>int</em>) – Width of first column of the workbook.</p></li>
<li><p><strong>last_col_width</strong> (<em>int</em>) – Optional width of the last column of
the workbook (default = None).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple = (the created workbook (openpyxl workbook),</dt><dd><p>a formatted sheet of the workbook (openpyxl sheet)).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(tup)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.useful_functs.mise_en_page">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.useful_functs.</span></span><span class="sig-name descname"><span class="pre">mise_en_page</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">institute</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">org_tup</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">if_database</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/useful_functs.html#mise_en_page"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.useful_functs.mise_en_page" title="Link to this definition"></a></dt>
<dd><p>Formats a worksheet of an openpyxl workbook using
columns attributes got through the <cite>set_col_attr</cite> function
imported from the <cite>bmfuncts.rename_cols</cite> module.
When the workbook wb is not None, this is applied
to the active worksheet of the passed workbook.
If the workbook wb is None, then the workbook is created.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>institute</strong> (<em>str</em>) – The Intitute name.</p></li>
<li><p><strong>org_tup</strong> (<em>tup</em>) – The tuple of the organization structure
of the Institute.</p></li>
<li><p><strong>df</strong> (<em>dataframe</em>) – The dataframe to be formatted.</p></li>
<li><p><strong>wb</strong> (<em>openpyxl workbook</em>) – Worbook of the worksheet
to be formatted (default = None).</p></li>
<li><p><strong>if_database</strong> (<em>bool</em>) – Status of the kind of data to be formatted
for setting columns attributes
(True if impact-factors database,
default = False).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Tuple = (worbook of the formatted worksheet (openpyxl workbook),</dt><dd><p>formatted active sheet).</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(tup)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.useful_functs.read_parsing_dict">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.useful_functs.</span></span><span class="sig-name descname"><span class="pre">read_parsing_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parsing_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_filename_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_extent</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/useful_functs.html#read_parsing_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.useful_functs.read_parsing_dict" title="Link to this definition"></a></dt>
<dd><p>Reads the dataframes of the parsing results from files of a specifyed type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parsing_path</strong> (<em>path</em>) – Full path to the folder where the the parsing
results are located.</p></li>
<li><p><strong>item_filename_dict</strong> (<em>dict</em>) – Dict keyyed by the parsing items and valued
by the file names of the parsing results.</p></li>
<li><p><strong>save_extent</strong> (<em>str</em>) – File type given by file extension without the dot seprator
(ex: “xlsx” for Excel file type).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>Parsing results keyyed by parsing items</dt><dd><p>given by ‘PARSING_ITEMS_LIST’ global
imported from the package imported as bp
and valued by the dataframes of parsing results.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(dict)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.useful_functs.save_fails_dict">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.useful_functs.</span></span><span class="sig-name descname"><span class="pre">save_fails_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fails_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parsing_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/useful_functs.html#save_fails_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.useful_functs.save_fails_dict" title="Link to this definition"></a></dt>
<dd><p>The function <cite>save_fails_dict</cite> saves parsing fails in a json file
named by the global PARSING_PERF imported from the module imported as pg.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fails_dict</strong> (<em>dict</em>) – The dict of parsing fails.</p></li>
<li><p><strong>parsing_path</strong> (<em>path</em>) – The full path to the parsing results folder
where the json file is saved.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.useful_functs.save_parsing_dict">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.useful_functs.</span></span><span class="sig-name descname"><span class="pre">save_parsing_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parsing_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parsing_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">item_filename_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_extent</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dedup_infos</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/useful_functs.html#save_parsing_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.useful_functs.save_parsing_dict" title="Link to this definition"></a></dt>
<dd><p>Saves the dataframes passed through the dict of parsing results
as files of a specifyed type.
It may manage the final saving of the deduplication results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parsing_dict</strong> (<em>dict</em>) – Parsing results keyyed by parsing items
given by ‘PARSING_ITEMS_LIST’ global
imported from the package imported as bp
and valued by the dataframes of parsing results.</p></li>
<li><p><strong>parsing_path</strong> (<em>path</em>) – Full path to the folder for saving
the parsing results.</p></li>
<li><p><strong>item_filename_dict</strong> (<em>dict</em>) – Dict keyyed by the parsing items and valued
by the file names for saving the parsing results.</p></li>
<li><p><strong>save_extent</strong> (<em>str</em>) – File type given by file extension without the dot seprator
(ex: “xlsx” for Excel file type).</p></li>
<li><p><strong>dedup_infos</strong> (<em>tup</em>) – Optional tuple for final saving of deduplication results
= (Full path to working folder (path),
Data combination type from corpuses databases (str),
4 digits year of the corpus (str)) (default = None).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="bmfuncts.useful_functs.set_rawdata">
<span class="sig-prename descclassname"><span class="pre">bmfuncts.useful_functs.</span></span><span class="sig-name descname"><span class="pre">set_rawdata</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bibliometer_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datatype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">years_list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">database</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/bmfuncts/useful_functs.html#set_rawdata"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#bmfuncts.useful_functs.set_rawdata" title="Link to this definition"></a></dt>
<dd><p>The function sets the rawdata to be used for the data type ‘datatype’ analysis.
It copies the files ending with ‘database_file_end’ from database folder
targeted by the path ‘database_folder_path’ to the rawdata folder
targeted by the path ‘rawdata_path’.
To do that it uses the <cite>_set_database_extract_info</cite> internal function.
When the database is Scopus and the data type to be analysed is restricted to WoS,
empty files ending with ‘database_file_end’ are used as Scopus rawdata.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bibliometer_path</strong> (<em>path</em>) – The path to the working folder.</p></li>
<li><p><strong>datatype</strong> (<em>str</em>) – The data type of data combination type
from databases.</p></li>
<li><p><strong>years_list</strong> (<em>list</em>) – List of corpus years (4 digits str).</p></li>
<li><p><strong>database</strong> (<em>str</em>) – The database selected for the analysis.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>End message recalling the database and data type used.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(str)</p>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="gui.html" class="btn btn-neutral float-left" title="BiblioMeter bmgui package" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, BiblioMeter team, Liten, Leti, CEA.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>