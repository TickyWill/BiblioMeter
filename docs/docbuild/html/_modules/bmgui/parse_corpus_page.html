

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>bmgui.parse_corpus_page &mdash; BiblioMeter 5.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />
      <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=fd3f3429" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=ce74c6a2"></script>
      <script src="../../_static/doctools.js?v=9a2dae69"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            BiblioMeter
              <img src="../../_static/BM-logo.ico" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Description</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../description.html">BiblioMeter description</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">GUI</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../gui.html">BiblioMeter <cite>bmgui</cite> package</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Functions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../functions.html">BiblioMeter <cite>bmfuncts</cite> package</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">BiblioMeter</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">bmgui.parse_corpus_page</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for bmgui.parse_corpus_page</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot; `parse_corpus_page` module allows to parse the rawdata extracted </span>
<span class="sd">from the external databases and then the concatenation </span>
<span class="sd">and the deduplication of the parsings.&quot;&quot;&quot;</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;create_parsing_concat&#39;</span><span class="p">]</span>


<span class="c1"># Standard library imports</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">threading</span>
<span class="kn">import</span> <span class="nn">tkinter</span> <span class="k">as</span> <span class="nn">tk</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="n">font</span> <span class="k">as</span> <span class="n">tkFont</span>
<span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="n">messagebox</span>
<span class="kn">from</span> <span class="nn">tkinter</span> <span class="kn">import</span> <span class="n">ttk</span>

<span class="c1"># 3rd party imports</span>
<span class="kn">import</span> <span class="nn">BiblioParsing</span> <span class="k">as</span> <span class="nn">bp</span>

<span class="c1"># Local imports</span>
<span class="kn">import</span> <span class="nn">bmfuncts.pub_globals</span> <span class="k">as</span> <span class="nn">pg</span>
<span class="kn">import</span> <span class="nn">bmgui.gui_globals</span> <span class="k">as</span> <span class="nn">gg</span>
<span class="kn">from</span> <span class="nn">bmfuncts.config_utils</span> <span class="kn">import</span> <span class="n">set_org_params</span>
<span class="kn">from</span> <span class="nn">bmfuncts.config_utils</span> <span class="kn">import</span> <span class="n">set_user_config</span>
<span class="kn">from</span> <span class="nn">bmfuncts.useful_functs</span> <span class="kn">import</span> <span class="n">read_parsing_dict</span>
<span class="kn">from</span> <span class="nn">bmfuncts.useful_functs</span> <span class="kn">import</span> <span class="n">save_fails_dict</span>
<span class="kn">from</span> <span class="nn">bmfuncts.useful_functs</span> <span class="kn">import</span> <span class="n">save_parsing_dict</span>
<span class="kn">from</span> <span class="nn">bmgui.gui_utils</span> <span class="kn">import</span> <span class="n">disable_buttons</span>
<span class="kn">from</span> <span class="nn">bmgui.gui_utils</span> <span class="kn">import</span> <span class="n">enable_buttons</span>
<span class="kn">from</span> <span class="nn">bmgui.gui_utils</span> <span class="kn">import</span> <span class="n">existing_corpuses</span>
<span class="kn">from</span> <span class="nn">bmgui.gui_utils</span> <span class="kn">import</span> <span class="n">font_size</span>
<span class="kn">from</span> <span class="nn">bmgui.gui_utils</span> <span class="kn">import</span> <span class="n">mm_to_px</span>
<span class="kn">from</span> <span class="nn">bmgui.gui_utils</span> <span class="kn">import</span> <span class="n">place_after</span>
<span class="kn">from</span> <span class="nn">bmgui.gui_utils</span> <span class="kn">import</span> <span class="n">place_bellow</span>
<span class="kn">from</span> <span class="nn">bmgui.gui_utils</span> <span class="kn">import</span> <span class="n">set_exit_button</span>
<span class="kn">from</span> <span class="nn">bmgui.gui_utils</span> <span class="kn">import</span> <span class="n">set_page_title</span>


<span class="k">class</span> <span class="nc">CheckBoxCorpuses</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Displays status of parsing files through Checkbutton tkinter widgets.</span>

<span class="sd">    Args:</span>
<span class="sd">        year (str): Corpus year defined by 4 digits.</span>
<span class="sd">        wos_r (bool): Status of WoS raw-data file.</span>
<span class="sd">        wos_p (bool): Status of WoS parsing files.</span>
<span class="sd">        scopus_r (bool): Status of Scopus raw-data file.</span>
<span class="sd">        scopus_p (bool): Status of Scopus parsing files.</span>
<span class="sd">        concat (bool) : Status of concatenation and deduplication files.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">master</span><span class="p">,</span> <span class="n">year</span><span class="p">,</span> <span class="n">wos_r</span><span class="p">,</span> <span class="n">wos_p</span><span class="p">,</span>
                 <span class="n">scopus_r</span><span class="p">,</span> <span class="n">scopus_p</span><span class="p">,</span> <span class="n">concat</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">check_boxes_sep_space</span> <span class="o">=</span> <span class="n">mm_to_px</span><span class="p">(</span><span class="n">gg</span><span class="o">.</span><span class="n">REF_CHECK_BOXES_SEP_SPACE</span> <span class="o">*</span> <span class="n">master</span><span class="o">.</span><span class="n">width_sf_mm</span><span class="p">,</span>
                                              <span class="n">gg</span><span class="o">.</span><span class="n">PPI</span><span class="p">)</span>
        <span class="n">font</span> <span class="o">=</span> <span class="n">tkFont</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="n">family</span> <span class="o">=</span> <span class="n">gg</span><span class="o">.</span><span class="n">FONT_NAME</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="n">font_size</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">master</span><span class="o">.</span><span class="n">width_sf_min</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lab</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span>
                            <span class="n">text</span> <span class="o">=</span> <span class="s1">&#39;Année &#39;</span> <span class="o">+</span> <span class="n">year</span><span class="p">,</span>
                            <span class="n">font</span> <span class="o">=</span> <span class="n">font</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">wos_r</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">wos_r</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wos_r</span><span class="o">.</span><span class="n">select</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wos_p</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">wos_p</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wos_p</span><span class="o">.</span><span class="n">select</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scopus_r</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">scopus_r</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scopus_r</span><span class="o">.</span><span class="n">select</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scopus_p</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">scopus_p</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">scopus_p</span><span class="o">.</span><span class="n">select</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">concat</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Checkbutton</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">concat</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">concat</span><span class="o">.</span><span class="n">select</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">place</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lab</span><span class="o">.</span><span class="n">winfo_reqwidth</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lab</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">-</span><span class="n">a</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span> <span class="n">anchor</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wos_r</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">check_boxes_sep_space</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span> <span class="n">anchor</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wos_r</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span> <span class="o">=</span> <span class="s1">&#39;disabled&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wos_p</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">check_boxes_sep_space</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span> <span class="n">anchor</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wos_p</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span> <span class="o">=</span> <span class="s1">&#39;disabled&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scopus_r</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">check_boxes_sep_space</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span> <span class="n">anchor</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scopus_r</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span> <span class="o">=</span> <span class="s1">&#39;disabled&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scopus_p</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">check_boxes_sep_space</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span> <span class="n">anchor</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scopus_p</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span> <span class="o">=</span> <span class="s1">&#39;disabled&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">concat</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">+</span><span class="mi">5</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">check_boxes_sep_space</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">,</span> <span class="n">anchor</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">concat</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">state</span> <span class="o">=</span> <span class="s1">&#39;disabled&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">efface</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lab</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wos_r</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">wos_p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scopus_r</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">scopus_p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">concat</span><span class="p">):</span>
            <span class="n">x</span><span class="o">.</span><span class="n">place_forget</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">_create_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master</span><span class="p">,</span> <span class="n">pos_x_init</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The internal function `_create_table` creates the column names</span>
<span class="sd">    of the table displaying which files of the parsing step are available </span>
<span class="sd">    in the working folder.</span>
<span class="sd">    The positions of the table items are set using the argument &#39;pos_x_init&#39;, </span>
<span class="sd">    and the general properties of tkinter window as &#39;master&#39; class variables.</span>

<span class="sd">    Args:</span>
<span class="sd">        pos_x_init (int): The initial horizontal position in pixels to be used </span>
<span class="sd">                          for widgets location on the parsing page.</span>

<span class="sd">    Note:</span>
<span class="sd">        The functions &#39;font_size&#39; and &#39;mm_to_px&#39; are imported</span>
<span class="sd">        from the module &#39;gui_utils&#39; of the package &#39;bmgui&#39;.</span>
<span class="sd">        The globals &#39;FONT_NAME&#39; and &#39;PPI&#39; are imported from the module &#39;gui_globals&#39;</span>
<span class="sd">        of the package &#39;bmgui&#39;.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Internal functions</span>
    <span class="k">def</span> <span class="nf">_set_table_item</span><span class="p">(</span><span class="n">item_text</span><span class="p">,</span> <span class="n">item_pos_x</span><span class="p">):</span>
        <span class="n">item_case</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                       <span class="n">text</span> <span class="o">=</span> <span class="n">item_text</span><span class="p">,</span>
                       <span class="n">font</span> <span class="o">=</span> <span class="n">header_font</span><span class="p">)</span>
        <span class="n">item_case</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">item_pos_x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">pos_y_ref</span><span class="p">,</span> <span class="n">anchor</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TABLE</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item_case</span><span class="p">)</span>

    <span class="c1"># Setting specific font properties</span>
    <span class="n">ref_font_size</span> <span class="o">=</span> <span class="mi">11</span>
    <span class="n">local_font_size</span> <span class="o">=</span> <span class="n">font_size</span><span class="p">(</span><span class="n">ref_font_size</span><span class="p">,</span> <span class="n">master</span><span class="o">.</span><span class="n">width_sf_min</span><span class="p">)</span>
    <span class="n">header_font</span> <span class="o">=</span> <span class="n">tkFont</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="n">family</span> <span class="o">=</span> <span class="n">gg</span><span class="o">.</span><span class="n">FONT_NAME</span><span class="p">,</span>
                              <span class="n">size</span>   <span class="o">=</span> <span class="n">local_font_size</span><span class="p">)</span>

    <span class="c1"># Setting useful x position shift and y position reference in pixels</span>
    <span class="n">pos_x_shift</span> <span class="o">=</span> <span class="n">mm_to_px</span><span class="p">(</span><span class="mi">25</span> <span class="o">*</span> <span class="n">master</span><span class="o">.</span><span class="n">width_sf_mm</span><span class="p">,</span>  <span class="n">gg</span><span class="o">.</span><span class="n">PPI</span><span class="p">)</span>
    <span class="n">pos_y_ref</span>   <span class="o">=</span> <span class="n">mm_to_px</span><span class="p">(</span><span class="mi">30</span> <span class="o">*</span> <span class="n">master</span><span class="o">.</span><span class="n">height_sf_mm</span><span class="p">,</span> <span class="n">gg</span><span class="o">.</span><span class="n">PPI</span><span class="p">)</span> <span class="c1"># 35</span>

    <span class="c1"># Initializing x position in pixels</span>
    <span class="n">pos_x</span> <span class="o">=</span> <span class="n">pos_x_init</span>

    <span class="c1"># Mise en page tableau</span>
    <span class="n">item_text</span> <span class="o">=</span> <span class="s1">&#39;Wos</span><span class="se">\n</span><span class="s1">Données brutes&#39;</span>
    <span class="n">pos_x</span> <span class="o">+=</span> <span class="n">pos_x_shift</span>
    <span class="n">_set_table_item</span><span class="p">(</span><span class="n">item_text</span><span class="p">,</span> <span class="n">pos_x</span><span class="p">)</span>

    <span class="n">item_text</span> <span class="o">=</span> <span class="s1">&#39;Wos</span><span class="se">\n</span><span class="s1">Parsing&#39;</span>
    <span class="n">pos_x</span> <span class="o">+=</span> <span class="n">pos_x_shift</span>
    <span class="n">_set_table_item</span><span class="p">(</span><span class="n">item_text</span><span class="p">,</span> <span class="n">pos_x</span><span class="p">)</span>

    <span class="n">item_text</span> <span class="o">=</span> <span class="s1">&#39;Scopus</span><span class="se">\n</span><span class="s1">Données brutes&#39;</span>
    <span class="n">pos_x</span> <span class="o">+=</span> <span class="n">pos_x_shift</span>
    <span class="n">_set_table_item</span><span class="p">(</span><span class="n">item_text</span><span class="p">,</span> <span class="n">pos_x</span><span class="p">)</span>

    <span class="n">item_text</span> <span class="o">=</span> <span class="s1">&#39;Scopus</span><span class="se">\n</span><span class="s1">Parsing&#39;</span>
    <span class="n">pos_x</span> <span class="o">+=</span> <span class="n">pos_x_shift</span>
    <span class="n">_set_table_item</span><span class="p">(</span><span class="n">item_text</span><span class="p">,</span> <span class="n">pos_x</span><span class="p">)</span>

    <span class="n">item_text</span> <span class="o">=</span> <span class="s1">&#39;Synthèse du</span><span class="se">\n</span><span class="s1">parsing des BDD&#39;</span>
    <span class="n">pos_x</span> <span class="o">+=</span> <span class="n">pos_x_shift</span>
    <span class="n">_set_table_item</span><span class="p">(</span><span class="n">item_text</span><span class="p">,</span> <span class="n">pos_x</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master</span><span class="p">,</span> <span class="n">bibliometer_path</span><span class="p">,</span> <span class="n">pos_tup</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The internal function `_update` refreshes the current state</span>
<span class="sd">    of the files in the working folder using the `_create_table` </span>
<span class="sd">    internal function.</span>
<span class="sd">    It also updates the OptionMenu buttons used to select the year.</span>

<span class="sd">    Args:</span>
<span class="sd">        bibliometer_path (path): The path leading to the working folder.</span>
<span class="sd">        pos_tup (tup): Tuple = (x position (int) for widgets location, </span>
<span class="sd">                                y position (int) for widgets location, </span>
<span class="sd">                                space value (int) for widgets spacing).</span>

<span class="sd">    Note:</span>
<span class="sd">        The function &#39;mm_to_px&#39; is imported from the module &#39;gui_utils&#39;</span>
<span class="sd">        of the package &#39;bmgui&#39;.</span>
<span class="sd">        The functions &#39;existing_corpuses&#39;, &#39;font_size&#39; and &#39;place_after&#39;</span>
<span class="sd">        are imported from the module &#39;gui_utils&#39; of the package &#39;bmgui&#39;.</span>
<span class="sd">        The globals FONT_NAME and PPI are imported from the module &#39;gui_globals&#39;</span>
<span class="sd">        of the package &#39;bmgui&#39;.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Setting parameters from args</span>
    <span class="n">pos_x</span><span class="p">,</span> <span class="n">pos_y</span><span class="p">,</span> <span class="n">esp_ligne</span> <span class="o">=</span> <span class="n">pos_tup</span>
    
    <span class="c1"># Setting useful local variables for positions modification (globals to create ??)</span>
    <span class="c1"># numbers are reference values in mm for reference screen</span>
    <span class="n">eff_font_size</span> <span class="o">=</span> <span class="n">font_size</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">master</span><span class="o">.</span><span class="n">width_sf_min</span><span class="p">)</span>
    <span class="n">eff_dx</span>        <span class="o">=</span> <span class="n">mm_to_px</span><span class="p">(</span><span class="mi">1</span> <span class="o">*</span> <span class="n">master</span><span class="o">.</span><span class="n">width_sf_mm</span><span class="p">,</span>  <span class="n">gg</span><span class="o">.</span><span class="n">PPI</span><span class="p">)</span>
    <span class="n">eff_dy</span>        <span class="o">=</span> <span class="n">mm_to_px</span><span class="p">(</span><span class="mi">1</span> <span class="o">*</span> <span class="n">master</span><span class="o">.</span><span class="n">height_sf_mm</span><span class="p">,</span> <span class="n">gg</span><span class="o">.</span><span class="n">PPI</span><span class="p">)</span>

    <span class="c1"># Setting existing corpuses status</span>
    <span class="n">files_status</span> <span class="o">=</span> <span class="n">existing_corpuses</span><span class="p">(</span><span class="n">bibliometer_path</span><span class="p">)</span>
    <span class="n">master</span><span class="o">.</span><span class="n">list_corpus_year</span>    <span class="o">=</span> <span class="n">files_status</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">master</span><span class="o">.</span><span class="n">list_wos_rawdata</span>    <span class="o">=</span> <span class="n">files_status</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">master</span><span class="o">.</span><span class="n">list_wos_parsing</span>    <span class="o">=</span> <span class="n">files_status</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="n">master</span><span class="o">.</span><span class="n">list_scopus_rawdata</span> <span class="o">=</span> <span class="n">files_status</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">master</span><span class="o">.</span><span class="n">list_scopus_parsing</span> <span class="o">=</span> <span class="n">files_status</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
    <span class="n">master</span><span class="o">.</span><span class="n">list_dedup</span>          <span class="o">=</span> <span class="n">files_status</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>

    <span class="c1"># Setting useful local variables for default selection items in selection lists</span>
    <span class="n">default_year</span> <span class="o">=</span> <span class="n">master</span><span class="o">.</span><span class="n">list_corpus_year</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="c1"># ????</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">check</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">CHECK</span><span class="p">):</span>
        <span class="n">check</span><span class="o">.</span><span class="n">efface</span><span class="p">()</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">annee</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">master</span><span class="o">.</span><span class="n">list_corpus_year</span><span class="p">):</span>
        <span class="n">tmp</span> <span class="o">=</span> <span class="n">CheckBoxCorpuses</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                               <span class="n">master</span><span class="p">,</span>
                               <span class="n">annee</span><span class="p">,</span>
                               <span class="n">master</span><span class="o">.</span><span class="n">list_wos_rawdata</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                               <span class="n">master</span><span class="o">.</span><span class="n">list_wos_parsing</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                               <span class="n">master</span><span class="o">.</span><span class="n">list_scopus_rawdata</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                               <span class="n">master</span><span class="o">.</span><span class="n">list_scopus_parsing</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                               <span class="n">master</span><span class="o">.</span><span class="n">list_dedup</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">tmp</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">pos_x</span><span class="p">,</span>
                  <span class="n">y</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="n">esp_ligne</span> <span class="o">+</span> <span class="n">pos_y</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CHECK</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>

    <span class="n">_create_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master</span><span class="p">,</span> <span class="n">pos_x</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_launch_parsing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master</span><span class="p">,</span> <span class="n">corpus_year</span><span class="p">,</span> <span class="n">database_type</span><span class="p">,</span>
                    <span class="n">paths_tup</span><span class="p">,</span> <span class="n">pos_tup</span><span class="p">,</span> <span class="n">progress_callback</span><span class="p">):</span>    
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Launches parsing of raw-data of &#39;database_type&#39; database </span>
<span class="sd">    through `biblio_parser` function imported from 3rd party package </span>
<span class="sd">    imported as bp after check of database name and database raw-data </span>
<span class="sd">    availability.</span>
<span class="sd">    It saves the resulting parsing files using paths set through </span>
<span class="sd">    `set_user_config` function imported from `bmfuncts.config_utils` module.</span>
<span class="sd">    It updates the files status using the internal function `_update`.</span>

<span class="sd">    Args:</span>
<span class="sd">        corpus_year (str): Corpus year defined by 4 digits.</span>
<span class="sd">        database_type (str): Database name (ex: &#39;wos&#39; or &#39;scopus&#39;).</span>
<span class="sd">        paths_tup (tup): Tuple = (full path to working folder, </span>
<span class="sd">                         full path to institute-affiliations file, </span>
<span class="sd">                         full path to institutions-types file).</span>
<span class="sd">        pos_tup (tup): Tuple = (x position (int) for widgets location, </span>
<span class="sd">                                y position (int) for widgets location, </span>
<span class="sd">                                space value (int) for widgets spacing).</span>
<span class="sd">        progress_callback (function): Function for updating </span>
<span class="sd">                                      ProgressBar tkinter widget status.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Internal functions</span>
    <span class="k">def</span> <span class="nf">_corpus_parsing</span><span class="p">(</span><span class="n">rawdata_path</span><span class="p">,</span> <span class="n">parsing_path</span><span class="p">,</span>
                        <span class="n">database_type</span><span class="p">,</span> <span class="n">progress_callback</span><span class="p">):</span>
        <span class="n">progress_callback</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">parsing_path</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parsing_path</span><span class="p">)</span>
        <span class="n">parsing_tup</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">biblio_parser</span><span class="p">(</span><span class="n">rawdata_path</span><span class="p">,</span> <span class="n">database_type</span><span class="p">,</span>
                                       <span class="n">inst_filter_list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                                       <span class="n">country_affiliations_file_path</span> <span class="o">=</span> <span class="n">institute_affil_file_path</span><span class="p">,</span>
                                       <span class="n">inst_types_file_path</span> <span class="o">=</span> <span class="n">inst_types_file_path</span><span class="p">)</span>
        <span class="n">parsing_dict</span><span class="p">,</span> <span class="n">dic_failed</span> <span class="o">=</span> <span class="n">parsing_tup</span>
        <span class="n">progress_callback</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span>
        <span class="n">save_parsing_dict</span><span class="p">(</span><span class="n">parsing_dict</span><span class="p">,</span> <span class="n">parsing_path</span><span class="p">,</span>
                          <span class="n">item_filename_dict</span><span class="p">,</span> <span class="n">parsing_save_extent</span><span class="p">)</span>
        <span class="n">progress_callback</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span>
        <span class="n">save_fails_dict</span><span class="p">(</span><span class="n">dic_failed</span><span class="p">,</span> <span class="n">parsing_path</span><span class="p">)</span>
        <span class="n">progress_callback</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>

        <span class="n">articles_number</span> <span class="o">=</span> <span class="n">dic_failed</span><span class="p">[</span><span class="s2">&quot;number of article&quot;</span><span class="p">]</span>
        <span class="n">info_title</span>      <span class="o">=</span> <span class="s2">&quot;Information&quot;</span>
        <span class="n">info_text</span>       <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;Parsing&#39; de &#39;</span><span class="si">{</span><span class="n">database_type</span><span class="si">}</span><span class="s2">&#39; effectué pour l&#39;année </span><span class="si">{</span><span class="n">corpus_year</span><span class="si">}</span><span class="s2">.&quot;</span>
                           <span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">  Nombre d&#39;articles du corpus : </span><span class="si">{</span><span class="n">articles_number</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="n">info_title</span><span class="p">,</span> <span class="n">info_text</span><span class="p">)</span>
        
    <span class="c1"># Setting parameters from args</span>
    <span class="n">bibliometer_path</span><span class="p">,</span> <span class="n">institute_affil_file_path</span><span class="p">,</span> <span class="n">inst_types_file_path</span> <span class="o">=</span> <span class="n">paths_tup</span>
    <span class="n">pos_x</span><span class="p">,</span> <span class="n">pos_y</span><span class="p">,</span> <span class="n">esp_ligne</span> <span class="o">=</span> <span class="n">pos_tup</span>
            
    <span class="c1"># Getting the full paths of the working folder architecture for the corpus &quot;corpus_year&quot;</span>
    <span class="n">config_tup</span> <span class="o">=</span> <span class="n">set_user_config</span><span class="p">(</span><span class="n">bibliometer_path</span><span class="p">,</span> <span class="n">corpus_year</span><span class="p">,</span> <span class="n">pg</span><span class="o">.</span><span class="n">BDD_LIST</span><span class="p">)</span>
    <span class="n">rawdata_path_dict</span>  <span class="o">=</span> <span class="n">config_tup</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">parsing_path_dict</span>  <span class="o">=</span> <span class="n">config_tup</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">item_filename_dict</span> <span class="o">=</span> <span class="n">config_tup</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

    <span class="c1"># Setting useful paths for database &#39;database_type&#39;</span>
    <span class="n">rawdata_path</span> <span class="o">=</span> <span class="n">rawdata_path_dict</span><span class="p">[</span><span class="n">database_type</span><span class="p">]</span>
    <span class="n">parsing_path</span> <span class="o">=</span> <span class="n">parsing_path_dict</span><span class="p">[</span><span class="n">database_type</span><span class="p">]</span>

    <span class="c1"># Setting parsing files extension for saving</span>
    <span class="n">parsing_save_extent</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">TSV_SAVE_EXTENT</span>
    <span class="n">progress_callback</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

    <span class="c1"># Getting files status for corpus parsing</span>
    <span class="k">if</span> <span class="n">database_type</span> <span class="ow">in</span> <span class="n">pg</span><span class="o">.</span><span class="n">BDD_LIST</span><span class="p">:</span>
        <span class="n">rawdata_status</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">parsing_status</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">database_type</span> <span class="o">==</span> <span class="n">bp</span><span class="o">.</span><span class="n">WOS</span><span class="p">:</span>
            <span class="n">rawdata_status</span> <span class="o">=</span> <span class="n">master</span><span class="o">.</span><span class="n">list_wos_rawdata</span><span class="p">[</span><span class="n">master</span><span class="o">.</span><span class="n">list_corpus_year</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">corpus_year</span><span class="p">)]</span>
            <span class="n">parsing_status</span> <span class="o">=</span> <span class="n">master</span><span class="o">.</span><span class="n">list_wos_parsing</span><span class="p">[</span><span class="n">master</span><span class="o">.</span><span class="n">list_corpus_year</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">corpus_year</span><span class="p">)]</span>
        <span class="k">if</span> <span class="n">database_type</span> <span class="o">==</span> <span class="n">bp</span><span class="o">.</span><span class="n">SCOPUS</span><span class="p">:</span>
            <span class="n">rawdata_status</span> <span class="o">=</span> <span class="n">master</span><span class="o">.</span><span class="n">list_scopus_rawdata</span><span class="p">[</span><span class="n">master</span><span class="o">.</span><span class="n">list_corpus_year</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">corpus_year</span><span class="p">)]</span>
            <span class="n">parsing_status</span> <span class="o">=</span> <span class="n">master</span><span class="o">.</span><span class="n">list_scopus_parsing</span><span class="p">[</span><span class="n">master</span><span class="o">.</span><span class="n">list_corpus_year</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">corpus_year</span><span class="p">)]</span>

        <span class="c1"># Asking for confirmation of corpus year to parse</span>
        <span class="n">ask_title</span> <span class="o">=</span> <span class="s2">&quot;Confirmation de l&#39;année de traitement&quot;</span>
        <span class="n">ask_text</span>  <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Une procédure de &#39;parsing&#39; de &#39;</span><span class="si">{</span><span class="n">database_type</span><span class="si">}</span><span class="s2">&#39; &quot;</span>
                     <span class="sa">f</span><span class="s2">&quot;pour l&#39;année </span><span class="si">{</span><span class="n">corpus_year</span><span class="si">}</span><span class="s2"> a été lancée.&quot;</span>
                     <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2"> Confirmer ce choix ?&quot;</span><span class="p">)</span>
        <span class="n">answer_1</span>  <span class="o">=</span> <span class="n">messagebox</span><span class="o">.</span><span class="n">askokcancel</span><span class="p">(</span><span class="n">ask_title</span><span class="p">,</span> <span class="n">ask_text</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">answer_1</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">rawdata_status</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="n">progress_callback</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
                <span class="n">warning_title</span> <span class="o">=</span> <span class="s2">&quot;Attention ! Fichier manquant&quot;</span>
                <span class="n">warning_text</span>  <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Le fichier brut d&#39;extraction de &#39;</span><span class="si">{</span><span class="n">database_type</span><span class="si">}</span><span class="s2">&#39; &quot;</span>
                                 <span class="sa">f</span><span class="s2">&quot;de l&#39;année </span><span class="si">{</span><span class="n">corpus_year</span><span class="si">}</span><span class="s2"> n&#39;est pas disponible.&quot;</span>
                                 <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Le &#39;parsing&#39; correspondant ne peut être construit !&quot;</span>
                                 <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Ajoutez le fichier à l&#39;emplacement attendu &quot;</span>
                                 <span class="s2">&quot;et relancez le &#39;parsing&#39;.&quot;</span><span class="p">)</span>
                <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="n">warning_title</span><span class="p">,</span> <span class="n">warning_text</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">parsing_path</span><span class="p">):</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parsing_path</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">parsing_status</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="c1"># Ask to carry on with parsing if already done</span>
                    <span class="n">ask_title</span> <span class="o">=</span> <span class="s2">&quot;Confirmation de traitement&quot;</span>
                    <span class="n">ask_text</span>  <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Le &#39;parsing&#39; du corpus &#39;</span><span class="si">{</span><span class="n">database_type</span><span class="si">}</span><span class="s2">&#39; &quot;</span>
                                 <span class="sa">f</span><span class="s2">&quot;de l&#39;année </span><span class="si">{</span><span class="n">corpus_year</span><span class="si">}</span><span class="s2"> est déjà disponible.&quot;</span>
                                 <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Reconstruire le &#39;parsing&#39; ?&quot;</span><span class="p">)</span>
                    <span class="n">answer_2</span>  <span class="o">=</span> <span class="n">messagebox</span><span class="o">.</span><span class="n">askokcancel</span><span class="p">(</span><span class="n">ask_title</span><span class="p">,</span> <span class="n">ask_text</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">answer_2</span><span class="p">:</span>
                        <span class="c1"># Parse when already parsed and ok for reconstructing parsing</span>
                        <span class="n">_corpus_parsing</span><span class="p">(</span><span class="n">rawdata_path</span><span class="p">,</span> <span class="n">parsing_path</span><span class="p">,</span>
                                        <span class="n">database_type</span><span class="p">,</span> <span class="n">progress_callback</span><span class="p">)</span>    
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># Cancel parsing reconstruction</span>
                        <span class="n">progress_callback</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
                        <span class="n">info_title</span> <span class="o">=</span> <span class="s2">&quot;Information&quot;</span>
                        <span class="n">info_text</span>  <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Le &#39;parsing&#39; existant du corpus &#39;</span><span class="si">{</span><span class="n">database_type</span><span class="si">}</span><span class="s2">&#39; &quot;</span>
                                      <span class="sa">f</span><span class="s2">&quot;de l&#39;année </span><span class="si">{</span><span class="n">corpus_year</span><span class="si">}</span><span class="s2"> a été conservé.&quot;</span><span class="p">)</span>
                        <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="n">info_title</span><span class="p">,</span> <span class="n">info_text</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># Parse when not parsed yet</span>
                    <span class="n">_corpus_parsing</span><span class="p">(</span><span class="n">rawdata_path</span><span class="p">,</span> <span class="n">parsing_path</span><span class="p">,</span>
                                    <span class="n">database_type</span><span class="p">,</span> <span class="n">progress_callback</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">progress_callback</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
            <span class="n">info_title</span> <span class="o">=</span> <span class="s2">&quot;Information&quot;</span>
            <span class="n">info_text</span>  <span class="o">=</span> <span class="s2">&quot;Modifiez vos choix et relancez le &#39;parsing&#39;.&quot;</span>
            <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="n">info_title</span><span class="p">,</span> <span class="n">info_text</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">progress_callback</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">warning_title</span> <span class="o">=</span> <span class="s2">&quot;Attention : Erreur sur type de BDD&quot;</span>
        <span class="n">warning_text</span>  <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Le type de BDD </span><span class="si">{</span><span class="n">database_type</span><span class="si">}</span><span class="s2">&quot;</span>
                         <span class="s2">&quot; n&#39;est pas encore pris en compte.&quot;</span>
                         <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Le &#39;parsing&#39; correspondant ne peut être construit !&quot;</span>
                         <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Modifiez le type de BDD sélectionné et relancez le &#39;parsing&#39;.&quot;</span><span class="p">)</span>
        <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="n">warning_title</span><span class="p">,</span> <span class="n">warning_text</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_launch_synthese</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master</span><span class="p">,</span> <span class="n">corpus_year</span><span class="p">,</span> <span class="n">org_tup</span><span class="p">,</span> <span class="n">datatype</span><span class="p">,</span>
                     <span class="n">paths_tup</span><span class="p">,</span> <span class="n">pos_tup</span><span class="p">,</span> <span class="n">progress_callback</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;The internal function `_launch_synthese` concatenates and deduplicates </span>
<span class="sd">    the parsing from wos or scopus databases using the functions `concatenate_parsing` </span>
<span class="sd">    and `deduplicate_parsing` imported from 3rd party package imported as bp.</span>
<span class="sd">    It checks if all useful files are available in the working folder.</span>
<span class="sd">    It saves the resulting parsing files using paths set through `set_user_config` </span>
<span class="sd">    function imported from `bmfuncts.config_utils` module.</span>
<span class="sd">    It updates the files status using the internal function `_update`.</span>

<span class="sd">    Args:</span>
<span class="sd">        corpus_year (str): Corpus year defined by 4 digits.</span>
<span class="sd">        org_tup (tup): Contains Institute parameters.</span>
<span class="sd">        datatype (str): Data combination type from corpuses databases.</span>
<span class="sd">        paths_tup (tup): Tuple = (full path to working folder, </span>
<span class="sd">                         full path to institute-affiliations file, </span>
<span class="sd">                         full path to institutions-types file).</span>
<span class="sd">        pos_tup (tup): Tuple = (x position (int) for widgets location, </span>
<span class="sd">                                y position (int) for widgets location, </span>
<span class="sd">                                space value (int) for widgets spacing).</span>
<span class="sd">        progress_callback (function): Function for updating </span>
<span class="sd">                                      ProgressBar tkinter widget status.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Internal functions</span>
    <span class="k">def</span> <span class="nf">_deduplicate_corpus_parsing</span><span class="p">(</span><span class="n">progress_callback</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">concat_root_folder</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">concat_root_folder</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">concat_parsing_path</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">concat_parsing_path</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">dedup_root_folder</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">dedup_root_folder</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">dedup_parsing_path</span><span class="p">):</span>
            <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">dedup_parsing_path</span><span class="p">)</span>
            
        <span class="n">progress_callback</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>

        <span class="n">scopus_parsing_dict</span> <span class="o">=</span> <span class="n">read_parsing_dict</span><span class="p">(</span><span class="n">scopus_parsing_path</span><span class="p">,</span> <span class="n">item_filename_dict</span><span class="p">,</span>
                                                <span class="n">parsing_save_extent</span><span class="p">)</span>
        <span class="n">wos_parsing_dict</span> <span class="o">=</span> <span class="n">read_parsing_dict</span><span class="p">(</span><span class="n">wos_parsing_path</span><span class="p">,</span> <span class="n">item_filename_dict</span><span class="p">,</span>
                                             <span class="n">parsing_save_extent</span><span class="p">)</span>
        <span class="n">progress_callback</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
        <span class="n">concat_parsing_dict</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">concatenate_parsing</span><span class="p">(</span><span class="n">scopus_parsing_dict</span><span class="p">,</span> <span class="n">wos_parsing_dict</span><span class="p">,</span>
                                                     <span class="n">inst_filter_list</span> <span class="o">=</span> <span class="n">institutions_filter_list</span><span class="p">)</span>
        <span class="n">progress_callback</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
        <span class="n">save_parsing_dict</span><span class="p">(</span><span class="n">concat_parsing_dict</span><span class="p">,</span> <span class="n">concat_parsing_path</span><span class="p">,</span>
                          <span class="n">item_filename_dict</span><span class="p">,</span> <span class="n">parsing_save_extent</span><span class="p">)</span>
        <span class="n">progress_callback</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span>
        <span class="n">dedup_parsing_dict</span> <span class="o">=</span> <span class="n">bp</span><span class="o">.</span><span class="n">deduplicate_parsing</span><span class="p">(</span><span class="n">concat_parsing_dict</span><span class="p">,</span>
                                                    <span class="n">norm_inst_status</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                                                    <span class="n">inst_types_file_path</span> <span class="o">=</span> <span class="n">inst_types_file_path</span><span class="p">,</span>
                                                    <span class="n">country_affiliations_file_path</span> <span class="o">=</span> <span class="n">institute_affil_file_path</span><span class="p">)</span>
        <span class="n">progress_callback</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span>
        <span class="n">save_parsing_dict</span><span class="p">(</span><span class="n">dedup_parsing_dict</span><span class="p">,</span> <span class="n">dedup_parsing_path</span><span class="p">,</span>
                          <span class="n">item_filename_dict</span><span class="p">,</span> <span class="n">parsing_save_extent</span><span class="p">,</span>
                          <span class="n">dedup_infos</span> <span class="o">=</span> <span class="p">(</span><span class="n">bibliometer_path</span><span class="p">,</span> <span class="n">datatype</span><span class="p">,</span> <span class="n">corpus_year</span><span class="p">))</span>
        
        <span class="n">progress_callback</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
        
    <span class="c1"># Setting parameters from args</span>
    <span class="n">bibliometer_path</span><span class="p">,</span> <span class="n">institute_affil_file_path</span><span class="p">,</span> <span class="n">inst_types_file_path</span> <span class="o">=</span> <span class="n">paths_tup</span>
    <span class="n">pos_x</span><span class="p">,</span> <span class="n">pos_y</span><span class="p">,</span> <span class="n">esp_ligne</span> <span class="o">=</span> <span class="n">pos_tup</span>

    <span class="c1"># Setting Institute parameters</span>
    <span class="n">institutions_filter_list</span> <span class="o">=</span> <span class="n">org_tup</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

    <span class="c1"># Getting the full paths of the working folder architecture for the corpus &quot;corpus_year&quot;</span>
    <span class="n">config_tup</span> <span class="o">=</span> <span class="n">set_user_config</span><span class="p">(</span><span class="n">bibliometer_path</span><span class="p">,</span> <span class="n">corpus_year</span><span class="p">,</span> <span class="n">pg</span><span class="o">.</span><span class="n">BDD_LIST</span><span class="p">)</span>
    <span class="n">parsing_path_dict</span><span class="p">,</span> <span class="n">item_filename_dict</span> <span class="o">=</span> <span class="n">config_tup</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">config_tup</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>

    <span class="c1"># Setting useful paths for database &#39;database_type&#39;</span>
    <span class="n">scopus_parsing_path</span> <span class="o">=</span> <span class="n">parsing_path_dict</span><span class="p">[</span><span class="s2">&quot;scopus&quot;</span><span class="p">]</span>
    <span class="n">wos_parsing_path</span>    <span class="o">=</span> <span class="n">parsing_path_dict</span><span class="p">[</span><span class="s2">&quot;wos&quot;</span><span class="p">]</span>
    <span class="n">concat_root_folder</span>  <span class="o">=</span> <span class="n">parsing_path_dict</span><span class="p">[</span><span class="s2">&quot;concat_root&quot;</span><span class="p">]</span>
    <span class="n">concat_parsing_path</span> <span class="o">=</span> <span class="n">parsing_path_dict</span><span class="p">[</span><span class="s2">&quot;concat&quot;</span><span class="p">]</span>
    <span class="n">dedup_root_folder</span>   <span class="o">=</span> <span class="n">parsing_path_dict</span><span class="p">[</span><span class="s2">&quot;dedup_root&quot;</span><span class="p">]</span>
    <span class="n">dedup_parsing_path</span>  <span class="o">=</span> <span class="n">parsing_path_dict</span><span class="p">[</span><span class="s2">&quot;dedup&quot;</span><span class="p">]</span>

    <span class="c1"># Setting parsing files extension for saving</span>
    <span class="n">parsing_save_extent</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">TSV_SAVE_EXTENT</span>

    <span class="c1"># Getting files status for corpus concatenation and deduplication</span>
    <span class="n">wos_parsing_status</span>    <span class="o">=</span> <span class="n">master</span><span class="o">.</span><span class="n">list_wos_parsing</span><span class="p">[</span><span class="n">master</span><span class="o">.</span><span class="n">list_corpus_year</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">corpus_year</span><span class="p">)]</span>
    <span class="n">scopus_parsing_status</span> <span class="o">=</span> <span class="n">master</span><span class="o">.</span><span class="n">list_scopus_parsing</span><span class="p">[</span><span class="n">master</span><span class="o">.</span><span class="n">list_corpus_year</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">corpus_year</span><span class="p">)]</span>
    <span class="n">dedup_parsing_status</span>  <span class="o">=</span> <span class="n">master</span><span class="o">.</span><span class="n">list_dedup</span><span class="p">[</span><span class="n">master</span><span class="o">.</span><span class="n">list_corpus_year</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">corpus_year</span><span class="p">)]</span>
    <span class="n">progress_callback</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

    <span class="c1"># Asking for confirmation of corpus year to concatenate and deduplicate</span>
    <span class="n">ask_title</span> <span class="o">=</span> <span class="s2">&quot;Confirmation de l&#39;année de traitement&quot;</span>
    <span class="n">ask_text</span>  <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;La synthèse pour l&#39;année </span><span class="si">{</span><span class="n">corpus_year</span><span class="si">}</span><span class="s2"> a été lancée.&quot;</span>
                 <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Confirmer ce choix ?&quot;</span><span class="p">)</span>
    <span class="n">answer_1</span> <span class="o">=</span> <span class="n">messagebox</span><span class="o">.</span><span class="n">askokcancel</span><span class="p">(</span><span class="n">ask_title</span><span class="p">,</span> <span class="n">ask_text</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">answer_1</span><span class="p">:</span>

        <span class="c1"># Checking availability of parsing files </span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">wos_parsing_status</span><span class="p">:</span>
            <span class="n">progress_callback</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
            <span class="n">warning_title</span> <span class="o">=</span> <span class="s2">&quot;Attention ! Fichiers manquants&quot;</span>
            <span class="n">warning_text</span>  <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Le &#39;parsing&#39; de &#39;wos&#39; &quot;</span>
                             <span class="sa">f</span><span class="s2">&quot;de l&#39;année </span><span class="si">{</span><span class="n">corpus_year</span><span class="si">}</span><span class="s2"> n&#39;est pas disponible.&quot;</span>
                             <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">La synthèse correspondante ne peut pas encore être construite !&quot;</span>
                             <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">-1 Lancez le &#39;parsing&#39; manquant;&quot;</span>
                             <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">-2 Relancez la synthèse.&quot;</span><span class="p">)</span>
            <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="n">warning_title</span><span class="p">,</span> <span class="n">warning_text</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">scopus_parsing_status</span><span class="p">:</span>
            <span class="n">progress_callback</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
            <span class="n">warning_title</span> <span class="o">=</span> <span class="s2">&quot;Attention ! Fichiers manquants&quot;</span>
            <span class="n">warning_text</span>  <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;Le &#39;parsing&#39; de &#39;scopus&#39; &quot;</span>
                             <span class="sa">f</span><span class="s2">&quot;de l&#39;année </span><span class="si">{</span><span class="n">corpus_year</span><span class="si">}</span><span class="s2"> n&#39;est pas disponible.&quot;</span>
                             <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">La synthèse correspondante ne peut pas encore être construite !&quot;</span>
                             <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">-1 Lancez le &#39;parsing&#39; manquant;&quot;</span>
                             <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">-2 Relancez la synthèse.&quot;</span><span class="p">)</span>
            <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="n">warning_title</span><span class="p">,</span> <span class="n">warning_text</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">wos_parsing_status</span> <span class="ow">and</span> <span class="n">scopus_parsing_status</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">dedup_parsing_status</span><span class="p">:</span>
                <span class="c1"># Ask to carry on with concatenation and deduplication if already available</span>
                <span class="n">ask_title</span> <span class="o">=</span> <span class="s2">&quot;Reconstruction de la synthèse&quot;</span>
                <span class="n">ask_text</span>  <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;La synthèse pour l&#39;année </span><span class="si">{</span><span class="n">corpus_year</span><span class="si">}</span><span class="s2"> est déjà disponible.&quot;</span>
                             <span class="s2">&quot;</span><span class="se">\n\n</span><span class="s2">Reconstruire la synthèse ?&quot;</span><span class="p">)</span>
                <span class="n">answer_2</span> <span class="o">=</span> <span class="n">messagebox</span><span class="o">.</span><span class="n">askokcancel</span><span class="p">(</span><span class="n">ask_title</span><span class="p">,</span> <span class="n">ask_text</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">answer_2</span><span class="p">:</span>
                    <span class="n">_deduplicate_corpus_parsing</span><span class="p">(</span><span class="n">progress_callback</span><span class="p">)</span>
                    <span class="n">info_title</span> <span class="o">=</span> <span class="s2">&quot;Information&quot;</span>
                    <span class="n">info_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;La synthèse pour l&#39;année </span><span class="si">{</span><span class="n">corpus_year</span><span class="si">}</span><span class="s2"> a été reconstruite.&quot;</span>
                    <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="n">info_title</span><span class="p">,</span> <span class="n">info_text</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">progress_callback</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
                    <span class="n">info_title</span> <span class="o">=</span> <span class="s2">&quot;Information&quot;</span>
                    <span class="n">info_text</span> <span class="o">=</span> <span class="s2">&quot;La synthèse dejà disponible est conservée.&quot;</span>
                    <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="n">info_title</span><span class="p">,</span> <span class="n">info_text</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">_deduplicate_corpus_parsing</span><span class="p">(</span><span class="n">progress_callback</span><span class="p">)</span>
                <span class="n">info_title</span> <span class="o">=</span> <span class="s2">&quot;Information&quot;</span>
                <span class="n">info_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;La construction de la synthèse pour l&#39;année </span><span class="si">{</span><span class="n">corpus_year</span><span class="si">}</span><span class="s2"> est terminée.&quot;</span>
                <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="n">info_title</span><span class="p">,</span> <span class="n">info_text</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">progress_callback</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">info_title</span> <span class="o">=</span> <span class="s2">&quot;Information&quot;</span>
        <span class="n">info_text</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;La synthèse pour l&#39;année </span><span class="si">{</span><span class="n">corpus_year</span><span class="si">}</span><span class="s2"> est annulée.&quot;</span>
        <span class="n">messagebox</span><span class="o">.</span><span class="n">showinfo</span><span class="p">(</span><span class="n">info_title</span><span class="p">,</span> <span class="n">info_text</span><span class="p">)</span>        


<div class="viewcode-block" id="create_parsing_concat">
<a class="viewcode-back" href="../../gui.html#bmgui.parse_corpus_page.create_parsing_concat">[docs]</a>
<span class="k">def</span> <span class="nf">create_parsing_concat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master</span><span class="p">,</span> <span class="n">page_name</span><span class="p">,</span> <span class="n">institute</span><span class="p">,</span> <span class="n">bibliometer_path</span><span class="p">,</span> <span class="n">datatype</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Manages creation and use of widgets for corpus parsing through </span>
<span class="sd">    internal functions  `_launch_parsing`, `_launch_synthese` and `_update`.</span>

<span class="sd">    Args:</span>
<span class="sd">        page_name (str): Name of parsing page.</span>
<span class="sd">        institute (str): Institute name.</span>
<span class="sd">        bibliometer_path (path): Full path to working folder.</span>
<span class="sd">        datatype (str): Data combination type from corpuses databases.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Internal functions</span>
    <span class="k">def</span> <span class="nf">_launch_parsing_try</span><span class="p">(</span><span class="n">progress_callback</span><span class="p">):</span>
        <span class="n">paths_tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">bibliometer_path</span><span class="p">,</span>
                     <span class="n">institute_affil_file_path</span><span class="p">,</span>
                     <span class="n">inst_types_file_path</span><span class="p">)</span>
        <span class="n">parsing_year</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_year_pc_1</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">parsing_bdd</span> <span class="o">=</span> <span class="n">var_bdd_pc_1</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">_launch_parsing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master</span><span class="p">,</span> <span class="n">parsing_year</span><span class="p">,</span> <span class="n">parsing_bdd</span><span class="p">,</span>
                        <span class="n">paths_tup</span><span class="p">,</span> <span class="n">pos_tup</span><span class="p">,</span> <span class="n">progress_callback</span><span class="p">)</span>
        <span class="n">progress_bar</span><span class="o">.</span><span class="n">place_forget</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">_launch_synthese_try</span><span class="p">(</span><span class="n">progress_callback</span><span class="p">):</span>        
        <span class="n">synthese_year</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">var_year_pc_2</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
        <span class="n">_launch_synthese</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master</span><span class="p">,</span> <span class="n">synthese_year</span><span class="p">,</span>
                         <span class="n">org_tup</span><span class="p">,</span> <span class="n">datatype</span><span class="p">,</span>
                         <span class="n">paths_tup</span><span class="p">,</span> <span class="n">pos_tup</span><span class="p">,</span>
                         <span class="n">progress_callback</span><span class="p">)</span>
        <span class="n">progress_bar</span><span class="o">.</span><span class="n">place_forget</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">_update_progress</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
        <span class="n">progress_var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="n">progress_bar</span><span class="o">.</span><span class="n">update_idletasks</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;=</span> <span class="mi">100</span><span class="p">:</span>
            <span class="n">enable_buttons</span><span class="p">(</span><span class="n">parse_buttons_list</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_except_hook</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
        <span class="n">messagebox</span><span class="o">.</span><span class="n">showwarning</span><span class="p">(</span><span class="s2">&quot;Error&quot;</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span>
        <span class="n">progress_var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">enable_buttons</span><span class="p">(</span><span class="n">parse_buttons_list</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_start_launch_parsing_try</span><span class="p">():</span>
        <span class="n">disable_buttons</span><span class="p">(</span><span class="n">parse_buttons_list</span><span class="p">)</span>
        <span class="n">place_bellow</span><span class="p">(</span><span class="n">parsing_launch_button</span><span class="p">,</span>
                     <span class="n">progress_bar</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="o">-</span><span class="mi">80</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mi">15</span><span class="p">)</span>
        <span class="n">progress_var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">_launch_parsing_try</span><span class="p">,</span>
                         <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">_update_progress</span><span class="p">,))</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>        
        <span class="c1"># update files status</span>
        <span class="n">_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master</span><span class="p">,</span> <span class="n">bibliometer_path</span><span class="p">,</span> <span class="n">pos_tup</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_start_launch_synthese_try</span><span class="p">():</span>
        <span class="n">disable_buttons</span><span class="p">(</span><span class="n">parse_buttons_list</span><span class="p">)</span>
        <span class="n">place_after</span><span class="p">(</span><span class="n">synthese_launch_button</span><span class="p">,</span>
                    <span class="n">progress_bar</span><span class="p">,</span> <span class="n">dx</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span> <span class="n">dy</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">progress_var</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">threading</span><span class="o">.</span><span class="n">Thread</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">_launch_synthese_try</span><span class="p">,</span>
                         <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">_update_progress</span><span class="p">,))</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>        
        <span class="c1"># update files status</span>
        <span class="n">_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master</span><span class="p">,</span> <span class="n">bibliometer_path</span><span class="p">,</span> <span class="n">pos_tup</span><span class="p">)</span>


    <span class="c1"># Setting useful local variables for positions modification (globals to create ??)</span>
    <span class="c1"># numbers are reference values in mm for reference screen</span>
    <span class="n">position_selon_x_check</span>   <span class="o">=</span> <span class="n">mm_to_px</span><span class="p">(</span><span class="mi">70</span>  <span class="o">*</span> <span class="n">master</span><span class="o">.</span><span class="n">width_sf_mm</span><span class="p">,</span>  <span class="n">gg</span><span class="o">.</span><span class="n">PPI</span><span class="p">)</span>
    <span class="n">position_selon_y_check</span>   <span class="o">=</span> <span class="n">mm_to_px</span><span class="p">(</span><span class="mi">40</span>  <span class="o">*</span> <span class="n">master</span><span class="o">.</span><span class="n">height_sf_mm</span><span class="p">,</span> <span class="n">gg</span><span class="o">.</span><span class="n">PPI</span><span class="p">)</span>  <span class="c1">#40</span>
    <span class="n">espace_entre_ligne_check</span> <span class="o">=</span> <span class="n">mm_to_px</span><span class="p">(</span><span class="mi">10</span>  <span class="o">*</span> <span class="n">master</span><span class="o">.</span><span class="n">height_sf_mm</span><span class="p">,</span> <span class="n">gg</span><span class="o">.</span><span class="n">PPI</span><span class="p">)</span>
    <span class="n">labels_x_pos</span>             <span class="o">=</span> <span class="n">mm_to_px</span><span class="p">(</span><span class="mi">10</span>  <span class="o">*</span> <span class="n">master</span><span class="o">.</span><span class="n">width_sf_mm</span><span class="p">,</span>  <span class="n">gg</span><span class="o">.</span><span class="n">PPI</span><span class="p">)</span>
    <span class="n">labels_y_space</span>           <span class="o">=</span> <span class="n">mm_to_px</span><span class="p">(</span><span class="mi">10</span>  <span class="o">*</span> <span class="n">master</span><span class="o">.</span><span class="n">height_sf_mm</span><span class="p">,</span> <span class="n">gg</span><span class="o">.</span><span class="n">PPI</span><span class="p">)</span>
    <span class="n">status_label_y_pos</span>       <span class="o">=</span> <span class="n">mm_to_px</span><span class="p">(</span><span class="mi">25</span>  <span class="o">*</span> <span class="n">master</span><span class="o">.</span><span class="n">height_sf_mm</span><span class="p">,</span> <span class="n">gg</span><span class="o">.</span><span class="n">PPI</span><span class="p">)</span>  <span class="c1">#25</span>
    <span class="n">parsing_label_y_pos</span>      <span class="o">=</span> <span class="n">mm_to_px</span><span class="p">(</span><span class="mi">107</span> <span class="o">*</span> <span class="n">master</span><span class="o">.</span><span class="n">height_sf_mm</span><span class="p">,</span> <span class="n">gg</span><span class="o">.</span><span class="n">PPI</span><span class="p">)</span>
    <span class="n">synthese_label_y_pos</span>     <span class="o">=</span> <span class="n">mm_to_px</span><span class="p">(</span><span class="mi">135</span> <span class="o">*</span> <span class="n">master</span><span class="o">.</span><span class="n">height_sf_mm</span><span class="p">,</span> <span class="n">gg</span><span class="o">.</span><span class="n">PPI</span><span class="p">)</span>
    <span class="n">status_button_x_pos</span>      <span class="o">=</span> <span class="n">mm_to_px</span><span class="p">(</span><span class="mi">148</span> <span class="o">*</span> <span class="n">master</span><span class="o">.</span><span class="n">width_sf_mm</span><span class="p">,</span> <span class="n">gg</span><span class="o">.</span><span class="n">PPI</span><span class="p">)</span>  <span class="c1">#148</span>
    <span class="n">status_button_y_pos</span>      <span class="o">=</span> <span class="n">mm_to_px</span><span class="p">(</span><span class="mi">98</span>  <span class="o">*</span> <span class="n">master</span><span class="o">.</span><span class="n">height_sf_mm</span><span class="p">,</span> <span class="n">gg</span><span class="o">.</span><span class="n">PPI</span><span class="p">)</span>  <span class="c1">#98</span>
    <span class="n">dx_year_select</span>           <span class="o">=</span> <span class="n">mm_to_px</span><span class="p">(</span><span class="mi">1</span>   <span class="o">*</span> <span class="n">master</span><span class="o">.</span><span class="n">width_sf_mm</span><span class="p">,</span>  <span class="n">gg</span><span class="o">.</span><span class="n">PPI</span><span class="p">)</span>
    <span class="n">dy_year_select</span>           <span class="o">=</span> <span class="n">mm_to_px</span><span class="p">(</span><span class="mi">1</span>   <span class="o">*</span> <span class="n">master</span><span class="o">.</span><span class="n">height_sf_mm</span><span class="p">,</span> <span class="n">gg</span><span class="o">.</span><span class="n">PPI</span><span class="p">)</span>
    <span class="n">dx_bdd_select</span>            <span class="o">=</span> <span class="n">mm_to_px</span><span class="p">(</span><span class="mi">12</span>  <span class="o">*</span> <span class="n">master</span><span class="o">.</span><span class="n">width_sf_mm</span><span class="p">,</span>  <span class="n">gg</span><span class="o">.</span><span class="n">PPI</span><span class="p">)</span>  <span class="c1">#12</span>
    <span class="n">dy_bdd_select</span>            <span class="o">=</span> <span class="n">mm_to_px</span><span class="p">(</span><span class="mi">1</span>   <span class="o">*</span> <span class="n">master</span><span class="o">.</span><span class="n">height_sf_mm</span><span class="p">,</span> <span class="n">gg</span><span class="o">.</span><span class="n">PPI</span><span class="p">)</span>
    <span class="n">dx_launch</span>                <span class="o">=</span> <span class="n">mm_to_px</span><span class="p">(</span><span class="mi">15</span>  <span class="o">*</span> <span class="n">master</span><span class="o">.</span><span class="n">width_sf_mm</span><span class="p">,</span>  <span class="n">gg</span><span class="o">.</span><span class="n">PPI</span><span class="p">)</span>  <span class="c1">#15</span>
    <span class="n">dy_launch</span>                <span class="o">=</span> <span class="n">mm_to_px</span><span class="p">(</span><span class="mf">0.2</span> <span class="o">*</span> <span class="n">master</span><span class="o">.</span><span class="n">height_sf_mm</span><span class="p">,</span> <span class="n">gg</span><span class="o">.</span><span class="n">PPI</span><span class="p">)</span>    
    <span class="n">progress_bar_length_px</span> <span class="o">=</span> <span class="n">mm_to_px</span><span class="p">(</span><span class="mi">50</span> <span class="o">*</span> <span class="n">master</span><span class="o">.</span><span class="n">width_sf_mm</span><span class="p">,</span> <span class="n">gg</span><span class="o">.</span><span class="n">PPI</span><span class="p">)</span>
    <span class="n">eff_labels_font_size</span>     <span class="o">=</span> <span class="n">font_size</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="n">master</span><span class="o">.</span><span class="n">width_sf_min</span><span class="p">)</span>
    <span class="n">eff_select_font_size</span>     <span class="o">=</span> <span class="n">font_size</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">master</span><span class="o">.</span><span class="n">width_sf_min</span><span class="p">)</span>
    <span class="n">eff_buttons_font_size</span>    <span class="o">=</span> <span class="n">font_size</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="n">master</span><span class="o">.</span><span class="n">width_sf_min</span><span class="p">)</span>

    <span class="n">year_x_pos</span> <span class="o">=</span> <span class="n">labels_x_pos</span>
    <span class="n">parsing_year_y_pos</span>  <span class="o">=</span> <span class="n">parsing_label_y_pos</span> <span class="o">+</span> <span class="n">labels_y_space</span>
    <span class="n">synthese_year_y_pos</span> <span class="o">=</span> <span class="n">synthese_label_y_pos</span> <span class="o">+</span> <span class="n">labels_y_space</span>
    <span class="n">pos_tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">position_selon_x_check</span><span class="p">,</span>
               <span class="n">position_selon_y_check</span><span class="p">,</span>
               <span class="n">espace_entre_ligne_check</span><span class="p">)</span>    

    <span class="c1"># Setting useful local variables for default selection items in selection lists</span>
    <span class="n">default_year</span> <span class="o">=</span> <span class="n">master</span><span class="o">.</span><span class="n">list_corpus_year</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">default_bdd</span>  <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">BDD_LIST</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Getting institute parameters</span>
    <span class="n">org_tup</span> <span class="o">=</span> <span class="n">set_org_params</span><span class="p">(</span><span class="n">institute</span><span class="p">,</span> <span class="n">bibliometer_path</span><span class="p">)</span>

    <span class="c1"># Setting useful aliases</span>
    <span class="n">institutions_folder_alias</span>  <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">ARCHI_INSTITUTIONS</span><span class="p">[</span><span class="s2">&quot;root&quot;</span><span class="p">]</span>
    <span class="n">inst_aff_file_base_alias</span>   <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">ARCHI_INSTITUTIONS</span><span class="p">[</span><span class="s2">&quot;institute_affil_base&quot;</span><span class="p">]</span>
    <span class="n">inst_types_file_base_alias</span> <span class="o">=</span> <span class="n">pg</span><span class="o">.</span><span class="n">ARCHI_INSTITUTIONS</span><span class="p">[</span><span class="s2">&quot;inst_types_base&quot;</span><span class="p">]</span>

    <span class="c1"># Setting useful file names and paths for Institute affiliations</span>
    <span class="n">institute_affil_file</span> <span class="o">=</span> <span class="n">institute</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">inst_aff_file_base_alias</span>
    <span class="n">inst_types_file</span>      <span class="o">=</span> <span class="n">institute</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">inst_types_file_base_alias</span>
    <span class="n">institutions_folder_path</span> <span class="o">=</span> <span class="n">bibliometer_path</span> <span class="o">/</span> <span class="n">Path</span><span class="p">(</span><span class="n">institutions_folder_alias</span><span class="p">)</span>
    <span class="n">institute_affil_file_path</span> <span class="o">=</span> <span class="n">institutions_folder_path</span> <span class="o">/</span> <span class="n">Path</span><span class="p">(</span><span class="n">institute_affil_file</span><span class="p">)</span>
    <span class="n">inst_types_file_path</span> <span class="o">=</span> <span class="n">institutions_folder_path</span> <span class="o">/</span> <span class="n">Path</span><span class="p">(</span><span class="n">inst_types_file</span><span class="p">)</span>
    <span class="n">paths_tup</span> <span class="o">=</span> <span class="p">(</span><span class="n">bibliometer_path</span><span class="p">,</span>
                 <span class="n">institute_affil_file_path</span><span class="p">,</span>
                 <span class="n">inst_types_file_path</span><span class="p">)</span>

    <span class="c1"># Creating and setting widgets for page title and exit button</span>
    <span class="n">set_page_title</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master</span><span class="p">,</span> <span class="n">page_name</span><span class="p">,</span> <span class="n">institute</span><span class="p">,</span> <span class="n">datatype</span><span class="p">)</span>
    <span class="n">set_exit_button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master</span><span class="p">)</span>
    
    <span class="c1"># Handling exception</span>
    <span class="n">threading</span><span class="o">.</span><span class="n">excepthook</span> <span class="o">=</span> <span class="n">_except_hook</span>

    <span class="c1"># Initializing progress bar widget</span>
    <span class="n">progress_var</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">IntVar</span><span class="p">()</span>  <span class="c1"># Variable to keep track of the progress bar value</span>
    <span class="n">progress_bar</span> <span class="o">=</span> <span class="n">ttk</span><span class="o">.</span><span class="n">Progressbar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                   <span class="n">orient</span><span class="o">=</span><span class="s2">&quot;horizontal&quot;</span><span class="p">,</span>
                                   <span class="n">length</span><span class="o">=</span><span class="n">progress_bar_length_px</span><span class="p">,</span>
                                   <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;determinate&quot;</span><span class="p">,</span>
                                   <span class="n">variable</span><span class="o">=</span><span class="n">progress_var</span><span class="p">)</span>

    <span class="c1"># **************** Zone Statut des fichiers de &quot;parsing&quot;</span>
    <span class="c1"># Liste des checkbox des corpuses</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">CHECK</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">TABLE</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">font_statut</span> <span class="o">=</span> <span class="n">tkFont</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="n">family</span> <span class="o">=</span> <span class="n">gg</span><span class="o">.</span><span class="n">FONT_NAME</span><span class="p">,</span>
                              <span class="n">size</span>   <span class="o">=</span> <span class="n">eff_labels_font_size</span><span class="p">,</span>
                              <span class="n">weight</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">label_statut</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                            <span class="n">text</span> <span class="o">=</span> <span class="n">gg</span><span class="o">.</span><span class="n">TEXT_STATUT</span><span class="p">,</span>
                            <span class="n">font</span> <span class="o">=</span> <span class="n">font_statut</span><span class="p">)</span>
    <span class="n">label_statut</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">labels_x_pos</span><span class="p">,</span>
                       <span class="n">y</span> <span class="o">=</span> <span class="n">status_label_y_pos</span><span class="p">,</span>
                       <span class="n">anchor</span> <span class="o">=</span> <span class="s2">&quot;nw&quot;</span><span class="p">)</span>

    <span class="c1"># **************** Bouton pour actualiser la zone de stockage</span>
    <span class="n">font_exist_button</span> <span class="o">=</span> <span class="n">tkFont</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="n">family</span> <span class="o">=</span> <span class="n">gg</span><span class="o">.</span><span class="n">FONT_NAME</span><span class="p">,</span>
                                    <span class="n">size</span>   <span class="o">=</span> <span class="n">eff_buttons_font_size</span><span class="p">)</span>
    <span class="n">exist_button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                             <span class="n">text</span> <span class="o">=</span> <span class="n">gg</span><span class="o">.</span><span class="n">TEXT_UPDATE_STATUS</span><span class="p">,</span>
                             <span class="n">font</span> <span class="o">=</span> <span class="n">font_exist_button</span><span class="p">,</span>
                             <span class="n">command</span> <span class="o">=</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                                       <span class="n">master</span><span class="p">,</span>
                                                       <span class="n">bibliometer_path</span><span class="p">,</span>
                                                       <span class="n">pos_tup</span><span class="p">))</span>
    <span class="n">exist_button</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">status_button_x_pos</span><span class="p">,</span>
                       <span class="n">y</span> <span class="o">=</span> <span class="n">status_button_y_pos</span><span class="p">,</span>
                       <span class="n">anchor</span> <span class="o">=</span> <span class="s1">&#39;n&#39;</span><span class="p">)</span>

    <span class="c1"># **************** Zone Construction des fichiers de &quot;parsing&quot; par BDD</span>
    <span class="n">font_parsing</span> <span class="o">=</span> <span class="n">tkFont</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="n">family</span> <span class="o">=</span> <span class="n">gg</span><span class="o">.</span><span class="n">FONT_NAME</span><span class="p">,</span>
                               <span class="n">size</span>   <span class="o">=</span> <span class="n">eff_labels_font_size</span><span class="p">,</span>
                               <span class="n">weight</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">label_parsing</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                             <span class="n">text</span> <span class="o">=</span> <span class="n">gg</span><span class="o">.</span><span class="n">TEXT_PARSING</span><span class="p">,</span>
                             <span class="n">font</span> <span class="o">=</span> <span class="n">font_parsing</span><span class="p">)</span>
    <span class="n">label_parsing</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">labels_x_pos</span><span class="p">,</span>
                        <span class="n">y</span> <span class="o">=</span> <span class="n">parsing_label_y_pos</span><span class="p">,</span> <span class="n">anchor</span> <span class="o">=</span> <span class="s2">&quot;nw&quot;</span><span class="p">)</span>

    <span class="c1"># Choix de l&#39;année</span>
    <span class="n">font_year_pc_1</span> <span class="o">=</span> <span class="n">tkFont</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="n">family</span> <span class="o">=</span> <span class="n">gg</span><span class="o">.</span><span class="n">FONT_NAME</span><span class="p">,</span>
                                 <span class="n">size</span>   <span class="o">=</span> <span class="n">eff_select_font_size</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">label_year_pc_1</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                    <span class="n">text</span> <span class="o">=</span> <span class="n">gg</span><span class="o">.</span><span class="n">TEXT_YEAR_PC</span><span class="p">,</span>
                                    <span class="n">font</span> <span class="o">=</span> <span class="n">font_year_pc_1</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">label_year_pc_1</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">year_x_pos</span><span class="p">,</span>
                               <span class="n">y</span> <span class="o">=</span> <span class="n">parsing_year_y_pos</span><span class="p">,</span>
                               <span class="n">anchor</span> <span class="o">=</span> <span class="s2">&quot;nw&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">var_year_pc_1</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">var_year_pc_1</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">default_year</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">om_year_pc_1</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">OptionMenu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">var_year_pc_1</span><span class="p">,</span>
                                      <span class="o">*</span><span class="n">master</span><span class="o">.</span><span class="n">list_corpus_year</span><span class="p">)</span>
    <span class="n">font_year_pc_1</span> <span class="o">=</span> <span class="n">tkFont</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="n">family</span> <span class="o">=</span> <span class="n">gg</span><span class="o">.</span><span class="n">FONT_NAME</span><span class="p">,</span>
                                 <span class="n">size</span>   <span class="o">=</span> <span class="n">eff_buttons_font_size</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">om_year_pc_1</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">font</span> <span class="o">=</span> <span class="n">font_year_pc_1</span><span class="p">)</span>
    <span class="n">place_after</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_year_pc_1</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">om_year_pc_1</span><span class="p">,</span>
                <span class="n">dx</span> <span class="o">=</span> <span class="o">+</span> <span class="n">dx_year_select</span><span class="p">,</span>
                <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span> <span class="n">dy_year_select</span><span class="p">)</span>

    <span class="c1"># Choix de la BDD</span>
    <span class="n">font_bdd_pc_1</span> <span class="o">=</span> <span class="n">tkFont</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="n">family</span> <span class="o">=</span> <span class="n">gg</span><span class="o">.</span><span class="n">FONT_NAME</span><span class="p">,</span>
                                <span class="n">size</span>   <span class="o">=</span> <span class="n">eff_select_font_size</span><span class="p">)</span>
    <span class="n">label_bdd_pc_1</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                              <span class="n">text</span> <span class="o">=</span> <span class="n">gg</span><span class="o">.</span><span class="n">TEXT_BDD_PC</span><span class="p">,</span>
                              <span class="n">font</span> <span class="o">=</span> <span class="n">font_bdd_pc_1</span><span class="p">)</span>
    <span class="n">place_after</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">om_year_pc_1</span><span class="p">,</span>
                <span class="n">label_bdd_pc_1</span><span class="p">,</span>
                <span class="n">dx</span> <span class="o">=</span> <span class="n">dx_bdd_select</span><span class="p">,</span>
                <span class="n">dy</span> <span class="o">=</span> <span class="n">dy_bdd_select</span><span class="p">)</span>

    <span class="n">var_bdd_pc_1</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="n">var_bdd_pc_1</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">default_bdd</span><span class="p">)</span>
    <span class="n">om_bdd_pc_1</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">OptionMenu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                <span class="n">var_bdd_pc_1</span><span class="p">,</span>
                                <span class="o">*</span><span class="n">pg</span><span class="o">.</span><span class="n">BDD_LIST</span><span class="p">)</span>
    <span class="n">font_bdd_pc_1</span> <span class="o">=</span> <span class="n">tkFont</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="n">family</span> <span class="o">=</span> <span class="n">gg</span><span class="o">.</span><span class="n">FONT_NAME</span><span class="p">,</span>
                                <span class="n">size</span>   <span class="o">=</span> <span class="n">eff_buttons_font_size</span><span class="p">)</span>
    <span class="n">om_bdd_pc_1</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">font</span> <span class="o">=</span> <span class="n">font_bdd_pc_1</span><span class="p">)</span>
    <span class="n">place_after</span><span class="p">(</span><span class="n">label_bdd_pc_1</span><span class="p">,</span>
                <span class="n">om_bdd_pc_1</span><span class="p">,</span>
                <span class="n">dx</span> <span class="o">=</span> <span class="o">+</span> <span class="n">dx_year_select</span><span class="p">,</span>
                <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span> <span class="n">dy_year_select</span><span class="p">)</span>

    <span class="c1"># Lancement du parsing</span>
    <span class="n">parsing_launch_font</span> <span class="o">=</span> <span class="n">tkFont</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="n">family</span> <span class="o">=</span> <span class="n">gg</span><span class="o">.</span><span class="n">FONT_NAME</span><span class="p">,</span>
                                      <span class="n">size</span>   <span class="o">=</span> <span class="n">eff_buttons_font_size</span><span class="p">)</span>
    <span class="n">parsing_launch_button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                      <span class="n">text</span> <span class="o">=</span> <span class="n">gg</span><span class="o">.</span><span class="n">TEXT_LAUNCH_PARSING</span><span class="p">,</span>
                                      <span class="n">font</span> <span class="o">=</span> <span class="n">parsing_launch_font</span><span class="p">,</span>
                                      <span class="n">command</span> <span class="o">=</span> <span class="n">_start_launch_parsing_try</span><span class="p">)</span>
    <span class="n">place_after</span><span class="p">(</span><span class="n">om_bdd_pc_1</span><span class="p">,</span>
                <span class="n">parsing_launch_button</span><span class="p">,</span>
                <span class="n">dx</span> <span class="o">=</span> <span class="n">dx_launch</span><span class="p">,</span>
                <span class="n">dy</span> <span class="o">=</span> <span class="n">dy_launch</span><span class="p">)</span>

    <span class="c1"># **************** Zone Synthèse des fichiers de parsing de toutes les BDD</span>
    <span class="n">font_synthese</span> <span class="o">=</span> <span class="n">tkFont</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="n">family</span> <span class="o">=</span> <span class="n">gg</span><span class="o">.</span><span class="n">FONT_NAME</span><span class="p">,</span>
                                <span class="n">size</span>   <span class="o">=</span> <span class="n">eff_labels_font_size</span><span class="p">,</span>
                                <span class="n">weight</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">label_synthese</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                              <span class="n">text</span> <span class="o">=</span> <span class="n">gg</span><span class="o">.</span><span class="n">TEXT_SYNTHESE</span><span class="p">,</span>
                              <span class="n">font</span> <span class="o">=</span> <span class="n">font_synthese</span><span class="p">)</span>
    <span class="n">label_synthese</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">labels_x_pos</span><span class="p">,</span>
                         <span class="n">y</span> <span class="o">=</span> <span class="n">synthese_label_y_pos</span><span class="p">,</span>
                         <span class="n">anchor</span> <span class="o">=</span> <span class="s2">&quot;nw&quot;</span><span class="p">)</span>

    <span class="c1"># Choix de l&#39;année</span>
    <span class="n">font_year_pc_2</span> <span class="o">=</span> <span class="n">tkFont</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="n">family</span> <span class="o">=</span> <span class="n">gg</span><span class="o">.</span><span class="n">FONT_NAME</span><span class="p">,</span>
                                 <span class="n">size</span>   <span class="o">=</span> <span class="n">eff_select_font_size</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">label_year_pc_2</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                    <span class="n">text</span> <span class="o">=</span> <span class="n">gg</span><span class="o">.</span><span class="n">TEXT_YEAR_PC</span><span class="p">,</span>
                                    <span class="n">font</span> <span class="o">=</span> <span class="n">font_year_pc_2</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">label_year_pc_2</span><span class="o">.</span><span class="n">place</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">year_x_pos</span><span class="p">,</span>
                               <span class="n">y</span> <span class="o">=</span> <span class="n">synthese_year_y_pos</span><span class="p">,</span>
                               <span class="n">anchor</span> <span class="o">=</span> <span class="s2">&quot;nw&quot;</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">var_year_pc_2</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">StringVar</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">var_year_pc_2</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">master</span><span class="o">.</span><span class="n">list_corpus_year</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">om_year_pc_2</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">OptionMenu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                      <span class="bp">self</span><span class="o">.</span><span class="n">var_year_pc_2</span><span class="p">,</span>
                                      <span class="o">*</span><span class="n">master</span><span class="o">.</span><span class="n">list_corpus_year</span><span class="p">)</span>
    <span class="n">font_year_pc_2</span> <span class="o">=</span> <span class="n">tkFont</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="n">family</span> <span class="o">=</span> <span class="n">gg</span><span class="o">.</span><span class="n">FONT_NAME</span><span class="p">,</span>
                                 <span class="n">size</span>   <span class="o">=</span> <span class="n">eff_buttons_font_size</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">om_year_pc_2</span><span class="o">.</span><span class="n">config</span><span class="p">(</span><span class="n">font</span> <span class="o">=</span> <span class="n">font_year_pc_2</span><span class="p">)</span>
    <span class="n">place_after</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label_year_pc_2</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">om_year_pc_2</span><span class="p">,</span>
                <span class="n">dx</span> <span class="o">=</span> <span class="o">+</span> <span class="n">dx_year_select</span><span class="p">,</span>
                <span class="n">dy</span> <span class="o">=</span> <span class="o">-</span> <span class="n">dy_year_select</span><span class="p">)</span>

    <span class="c1"># Lancement de la synthèse</span>
    <span class="n">synthese_launch_font</span> <span class="o">=</span> <span class="n">tkFont</span><span class="o">.</span><span class="n">Font</span><span class="p">(</span><span class="n">family</span> <span class="o">=</span> <span class="n">gg</span><span class="o">.</span><span class="n">FONT_NAME</span><span class="p">,</span>
                                       <span class="n">size</span>   <span class="o">=</span> <span class="n">eff_buttons_font_size</span><span class="p">)</span>
    <span class="n">synthese_launch_button</span> <span class="o">=</span> <span class="n">tk</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                                     <span class="n">text</span> <span class="o">=</span> <span class="n">gg</span><span class="o">.</span><span class="n">TEXT_LAUNCH_SYNTHESE</span><span class="p">,</span>
                                     <span class="n">font</span> <span class="o">=</span> <span class="n">synthese_launch_font</span><span class="p">,</span>
                                     <span class="n">command</span> <span class="o">=</span> <span class="n">_start_launch_synthese_try</span><span class="p">)</span>
    <span class="n">place_after</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">om_year_pc_2</span><span class="p">,</span>
                <span class="n">synthese_launch_button</span><span class="p">,</span>
                <span class="n">dx</span> <span class="o">=</span> <span class="n">dx_launch</span><span class="p">,</span>
                <span class="n">dy</span> <span class="o">=</span> <span class="n">dy_launch</span><span class="p">)</span>

    <span class="c1"># **************** Placement de CHECKBOXCORPUSES :</span>
    <span class="n">_update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">master</span><span class="p">,</span> <span class="n">bibliometer_path</span><span class="p">,</span> <span class="n">pos_tup</span><span class="p">)</span>
    
    <span class="c1"># Setting buttons list for status change</span>
    <span class="n">parse_buttons_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">exist_button</span><span class="p">,</span>
                          <span class="bp">self</span><span class="o">.</span><span class="n">om_year_pc_1</span><span class="p">,</span>
                          <span class="n">om_bdd_pc_1</span><span class="p">,</span>
                          <span class="bp">self</span><span class="o">.</span><span class="n">om_year_pc_2</span><span class="p">,</span>
                          <span class="n">parsing_launch_button</span><span class="p">,</span>
                          <span class="n">synthese_launch_button</span><span class="p">]</span></div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, BiblioMeter team, Liten, Leti, CEA.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>